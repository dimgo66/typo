## Описание проекта

### Цели
- Автоматизация типографской обработки русскоязычных текстов в формате .docx с сохранением форматирования и сносок.
- Минимизация ручной работы редакторов и корректоров.
- Обеспечение консистентности оформления документов.

### Архитектура
- Серверная обработка реализована на Next.js (API route).
- Для работы с .docx используется PizZip (чтение/запись XML внутри архива docx).
- Типографика реализована в модуле AdvancedTypographyProcessor (lib/typography.ts).
- Обрабатываются только части word/document.xml и word/footnotes.xml (сноски).
- Остальные части документа (endnotes, headers, comments и др.) не изменяются.
- Валидация XML: диагностика неэкранированных спецсимволов (&, <, >) вне тегов.

### Этапы разработки
1. Базовая обработка docx через PizZip и прямое редактирование XML.
2. Реализация типографских правил (длинное тире, диапазоны, сокращения, неразрывные пробелы и др.).
3. Сохранение форматирования и структуры документа.
4. Поддержка и обработка сносок (footnotes.xml).
5. Диагностика ошибок XML и информативные сообщения пользователю.
6. Тестирование edge-кейсов, исправление багов.
7. Доработка документации и подготовка к публикации.

### Используемые технологии
- Next.js (серверная часть)
- PizZip (работа с docx)
- Node.js Buffer
- TypeScript
- Собственный модуль типографики (lib/typography.ts)

### Стандарты и поддерживаемость
- Код покрыт комментариями, архитектура модульная.
- Все ключевые правила типографики вынесены в отдельный модуль.
- Документация ведётся в папке docs (Project.md, Tasktracker.md, Diary.md, qa.md).
- Поддерживается только формат .docx (doc, txt и др. не принимаются).
- Имя выходного файла транслитерируется, лишние символы и суффиксы удаляются.
- Все изменения и решения фиксируются в Diary.md.

### Ограничения
- Поддерживаются только файлы .docx (Word 2007+).
- Сохраняется только основное форматирование и сноски.
- Не обрабатываются endnotes, headers, comments и др.
- Не поддерживаются .doc, .txt и другие форматы.

### Типографские правила (основные)
- Множественные пробелы заменяются на один, пробелы в начале/конце строк удаляются.
- Дефисы между словами и в начале строки заменяются на длинное тире (—) по правилам.
- Диапазоны чисел (1966-1977) заменяются на en dash (–).
- Все случаи "пробел en dash пробел" и "пробел—пробел" заменяются на неразрывный пробел—обычный пробел ( — ).
- Защита сокращений (т.-е., и т.д.), сложных слов (всё-таки, по-русски и др.).
- Не вставляется неразрывный пробел внутри сложных слов.
- Диагностика ошибок XML и информативные сообщения пользователю.

### Поддерживаемость
- Проект сопровождается через Tasktracker.md и Diary.md.
- Все архитектурные вопросы фиксируются в qa.md.
- Готов к расширению (например, для поддержки других частей docx или новых правил типографики). 