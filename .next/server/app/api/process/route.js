"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/process/route";
exports.ids = ["app/api/process/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "undici?6303":
/*!*************************!*\
  !*** external "undici" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("undici");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Volumes_Store1_Yandex_Disk_localized_www_yandex_typography_app_app_api_process_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/process/route.ts */ \"(rsc)/./app/api/process/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/process/route\",\n        pathname: \"/api/process\",\n        filename: \"route\",\n        bundlePath: \"app/api/process/route\"\n    },\n    resolvedPagePath: \"/Volumes/Store1/Yandex.Disk.localized/www-yandex/typography-app/app/api/process/route.ts\",\n    nextConfigOutput,\n    userland: _Volumes_Store1_Yandex_Disk_localized_www_yandex_typography_app_app_api_process_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/process/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm9jZXNzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZwcm9jZXNzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcHJvY2VzcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZWb2x1bWVzJTJGU3RvcmUxJTJGWWFuZGV4LkRpc2subG9jYWxpemVkJTJGd3d3LXlhbmRleCUyRnR5cG9ncmFwaHktYXBwJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZWb2x1bWVzJTJGU3RvcmUxJTJGWWFuZGV4LkRpc2subG9jYWxpemVkJTJGd3d3LXlhbmRleCUyRnR5cG9ncmFwaHktYXBwJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDd0M7QUFDckg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90eXBvZ3JhcGh5LWFwcC8/MmFkMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVm9sdW1lcy9TdG9yZTEvWWFuZGV4LkRpc2subG9jYWxpemVkL3d3dy15YW5kZXgvdHlwb2dyYXBoeS1hcHAvYXBwL2FwaS9wcm9jZXNzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcHJvY2Vzcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Byb2Nlc3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3Byb2Nlc3Mvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVm9sdW1lcy9TdG9yZTEvWWFuZGV4LkRpc2subG9jYWxpemVkL3d3dy15YW5kZXgvdHlwb2dyYXBoeS1hcHAvYXBwL2FwaS9wcm9jZXNzL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wcm9jZXNzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/process/route.ts":
/*!**********************************!*\
  !*** ./app/api/process/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var mammoth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mammoth */ \"(rsc)/./node_modules/mammoth/lib/index.js\");\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! cheerio */ \"(rsc)/./node_modules/cheerio/dist/esm/index.js\");\n/* harmony import */ var _lib_typography__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/typography */ \"(rsc)/./lib/typography.ts\");\n/* harmony import */ var docx__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! docx */ \"(rsc)/./node_modules/docx/dist/index.mjs\");\n/* harmony import */ var pizzip__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pizzip */ \"(rsc)/./node_modules/pizzip/js/index.js\");\n/* harmony import */ var pizzip__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(pizzip__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n\nfunction typographHtml(html) {\n    const $ = cheerio__WEBPACK_IMPORTED_MODULE_2__.load(html);\n    $(\"body, body *\").contents().each(function() {\n        if (this.type === \"text\") {\n            this.data = (0,_lib_typography__WEBPACK_IMPORTED_MODULE_3__.typographText)(this.data || \"\");\n        }\n    });\n    return $.html();\n}\nfunction transliterate(str) {\n    const map = {\n        А: \"A\",\n        Б: \"B\",\n        В: \"V\",\n        Г: \"G\",\n        Д: \"D\",\n        Е: \"E\",\n        Ё: \"E\",\n        Ж: \"Zh\",\n        З: \"Z\",\n        И: \"I\",\n        Й: \"Y\",\n        К: \"K\",\n        Л: \"L\",\n        М: \"M\",\n        Н: \"N\",\n        О: \"O\",\n        П: \"P\",\n        Р: \"R\",\n        С: \"S\",\n        Т: \"T\",\n        У: \"U\",\n        Ф: \"F\",\n        Х: \"Kh\",\n        Ц: \"Ts\",\n        Ч: \"Ch\",\n        Ш: \"Sh\",\n        Щ: \"Shch\",\n        Ъ: \"\",\n        Ы: \"Y\",\n        Ь: \"\",\n        Э: \"E\",\n        Ю: \"Yu\",\n        Я: \"Ya\",\n        а: \"a\",\n        б: \"b\",\n        в: \"v\",\n        г: \"g\",\n        д: \"d\",\n        е: \"e\",\n        ё: \"e\",\n        ж: \"zh\",\n        з: \"z\",\n        и: \"i\",\n        й: \"y\",\n        к: \"k\",\n        л: \"l\",\n        м: \"m\",\n        н: \"n\",\n        о: \"o\",\n        п: \"p\",\n        р: \"r\",\n        с: \"s\",\n        т: \"t\",\n        у: \"u\",\n        ф: \"f\",\n        х: \"kh\",\n        ц: \"ts\",\n        ч: \"ch\",\n        ш: \"sh\",\n        щ: \"shch\",\n        ъ: \"\",\n        ы: \"y\",\n        ь: \"\",\n        э: \"e\",\n        ю: \"yu\",\n        я: \"ya\",\n        \" \": \"_\",\n        \"—\": \"-\",\n        \"–\": \"-\",\n        \",\": \"\",\n        \".\": \"\",\n        \"\\xab\": \"\",\n        \"\\xbb\": \"\",\n        \"(\": \"\",\n        \")\": \"\",\n        \"[\": \"\",\n        \"]\": \"\",\n        \"{\": \"\",\n        \"}\": \"\",\n        \"/\": \"-\",\n        \"\\\\\": \"-\",\n        \"@\": \"at\",\n        \"#\": \"\",\n        \"$\": \"\",\n        \"%\": \"\",\n        \"^\": \"\",\n        \"&\": \"\",\n        \"*\": \"\",\n        \"+\": \"\",\n        \"=\": \"\",\n        \":\": \"\",\n        \";\": \"\",\n        \"?\": \"\",\n        \"!\": \"\",\n        '\"': \"\",\n        \"'\": \"\",\n        \"<\": \"\",\n        \">\": \"\",\n        \"|\": \"\",\n        \"`\": \"\",\n        \"~\": \"\"\n    };\n    return str.split(\"\").map((char)=>map[char] !== undefined ? map[char] : char).join(\"\");\n}\nfunction parseRuns($, $elem, parentStyle = {}) {\n    const runs = [];\n    $elem.contents().each((_, node)=>{\n        let style = {\n            ...parentStyle\n        };\n        if (node.type === \"tag\") {\n            if (node.name === \"b\" || node.name === \"strong\") style.bold = true;\n            if (node.name === \"i\" || node.name === \"em\") style.italics = true;\n            if (node.name === \"u\") style.underline = {};\n            if (node.name === \"span\" && node.attribs && node.attribs.style) {\n                const s = node.attribs.style;\n                const colorMatch = s.match(/color:\\s*([^;]+)/i);\n                if (colorMatch) style.color = colorMatch[1].replace(\"#\", \"\");\n                const sizeMatch = s.match(/font-size:\\s*(\\d+)px/i);\n                if (sizeMatch) style.size = Number(sizeMatch[1]) * 2;\n            }\n            runs.push(...parseRuns($, $(node), style));\n        } else if (node.type === \"text\") {\n            if (node.data && node.data.trim()) {\n                runs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.TextRun({\n                    text: node.data,\n                    ...style\n                }));\n            }\n        }\n    });\n    return runs;\n}\nfunction isEmptyParagraph(paragraph) {\n    // Вариант с root (docx >= 7)\n    if (Array.isArray(paragraph.root) && paragraph.root.length > 1) {\n        const textRun = paragraph.root[1];\n        if (textRun && Array.isArray(textRun.root) && textRun.root.length > 1) {\n            const textValue = textRun.root[1];\n            return textValue === \" \" || textValue === \"\\xa0\" || textValue === \"&nbsp;\";\n        }\n    }\n    // Старые варианты (на всякий случай)\n    if (paragraph.children && paragraph.children.length === 1) {\n        const t = paragraph.children[0];\n        const text = t.text || t.root && t.root.text;\n        return text === \"\\xa0\" || text === \"&nbsp;\" || text === \" \";\n    }\n    if (paragraph.options?.text !== undefined) {\n        return paragraph.options.text === \"\\xa0\" || paragraph.options.text === \"&nbsp;\" || paragraph.options.text === \" \";\n    }\n    return false;\n}\nfunction hasSignificantContent(paragraph) {\n    // Проверяем root (docx >= 7)\n    if (Array.isArray(paragraph.root) && paragraph.root.length > 1) {\n        const textRun = paragraph.root[1];\n        if (textRun && Array.isArray(textRun.root) && textRun.root.length > 1) {\n            const textValue = textRun.root[1];\n            // Считаем значимым только если есть буква или цифра\n            return /[A-Za-zА-Яа-яЁё0-9]/.test(textValue);\n        }\n    }\n    // Старые варианты (на всякий случай)\n    if (paragraph.children && paragraph.children.length === 1) {\n        const t = paragraph.children[0];\n        const text = t.text || t.root && t.root.text;\n        return /[A-Za-zА-Яа-яЁё0-9]/.test(text);\n    }\n    if (paragraph.options?.text !== undefined) {\n        return /[A-Za-zА-Яа-яЁё0-9]/.test(paragraph.options.text);\n    }\n    return false;\n}\nfunction isTrulyEmptyParagraph(paragraph) {\n    // Проверяем root (docx >= 7)\n    if (Array.isArray(paragraph.root) && paragraph.root.length > 1) {\n        const textRun = paragraph.root[1];\n        if (textRun && Array.isArray(textRun.root) && textRun.root.length > 1) {\n            const textValue = textRun.root[1];\n            return textValue === \" \" || textValue === \"\\xa0\" || textValue === \"&nbsp;\";\n        }\n    }\n    // Старые варианты (на всякий случай)\n    if (paragraph.children && paragraph.children.length === 1) {\n        const t = paragraph.children[0];\n        const text = t.text || t.root && t.root.text;\n        return text === \"\\xa0\" || text === \"&nbsp;\" || text === \" \";\n    }\n    if (paragraph.options?.text !== undefined) {\n        return paragraph.options.text === \"\\xa0\" || paragraph.options.text === \"&nbsp;\" || paragraph.options.text === \" \";\n    }\n    return false;\n}\nfunction trimTrailingEmptyParagraphs(paragraphs) {\n    let lastNonEmpty = paragraphs.length - 1;\n    for(; lastNonEmpty >= 0; lastNonEmpty--){\n        if (!isTrulyEmptyParagraph(paragraphs[lastNonEmpty])) {\n            break;\n        }\n    }\n    return paragraphs.slice(0, lastNonEmpty + 1);\n}\nfunction htmlToDocxParagraphs(html) {\n    const $ = cheerio__WEBPACK_IMPORTED_MODULE_2__.load(html);\n    const paragraphs = [];\n    let prevWasBlock = false;\n    $(\"body\").contents().each((_, elem)=>{\n        if (elem.type === \"tag\") {\n            if (elem.tagName === \"p\" || elem.tagName === \"div\") {\n                const innerHtml = $(elem).html()?.replace(/\\s|&nbsp;|<br\\s*\\/?>(?=\\s*<\\/p>)/gi, \"\").trim();\n                if (!innerHtml) {\n                    paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph(\"\\xa0\"));\n                    prevWasBlock = true;\n                } else {\n                    const runs = parseRuns($, $(elem));\n                    if (runs.length) {\n                        paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph({\n                            children: runs\n                        }));\n                        prevWasBlock = true;\n                    } else {\n                        paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph(\"\\xa0\"));\n                        prevWasBlock = true;\n                    }\n                }\n            } else if (elem.tagName === \"br\") {\n                paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph(\"\\xa0\"));\n                prevWasBlock = true;\n            } else if (elem.tagName === \"ul\" || elem.tagName === \"ol\") {\n                $(elem).find(\"li\").each((_, li)=>{\n                    const runs = parseRuns($, $(li));\n                    if (runs.length) {\n                        paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph({\n                            children: runs,\n                            bullet: elem.tagName === \"ul\"\n                        }));\n                        prevWasBlock = true;\n                    }\n                });\n            } else if (elem.tagName === \"h1\" || elem.tagName === \"h2\" || elem.tagName === \"h3\") {\n                const runs = parseRuns($, $(elem));\n                if (runs.length) {\n                    paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph({\n                        children: runs,\n                        heading: elem.tagName.toUpperCase()\n                    }));\n                    prevWasBlock = true;\n                }\n            }\n        } else if (elem.type === \"text\") {\n            if (elem.data && elem.data.replace(/\\s+/g, \"\") === \"\") {\n                if (prevWasBlock) {\n                    paragraphs.push(new docx__WEBPACK_IMPORTED_MODULE_4__.Paragraph(\"\\xa0\"));\n                    prevWasBlock = false;\n                }\n            }\n        }\n    });\n    // Удаляем только хвост из truly empty абзацев\n    return trimTrailingEmptyParagraphs(paragraphs);\n}\n// Функция автозаполнения пустых абзацев DOCX\nfunction fillEmptyParagraphsInDocx(buffer) {\n    const zip = new (pizzip__WEBPACK_IMPORTED_MODULE_5___default())(buffer);\n    let xml = zip.file(\"word/document.xml\")?.asText();\n    if (!xml) return buffer;\n    const $ = (0,cheerio__WEBPACK_IMPORTED_MODULE_2__.load)(xml, {\n        xmlMode: true\n    });\n    $(\"*\").each((_, p)=>{\n        if (p.tagName === \"w:p\") {\n            const hasText = $(p).find(\"w\\\\:t, t\").filter((_, t)=>$(t).text().trim() !== \"\").length > 0;\n            if (!hasText) {\n                const run = $('<w:r><w:t xml:space=\"preserve\">&#160;</w:t></w:r>');\n                $(p).append(run);\n            }\n        }\n    });\n    const newXml = $.xml();\n    zip.file(\"word/document.xml\", newXml);\n    return zip.generate({\n        type: \"nodebuffer\"\n    });\n}\nasync function POST(request) {\n    try {\n        console.log(\"=== НАЧАЛО ОБРАБОТКИ ФАЙЛА (HTML-процессинг) ===\");\n        const formData = await request.formData();\n        const file = formData.get(\"file\");\n        const output = formData.get(\"output\")?.toLowerCase() || \"docx\";\n        if (!file) {\n            console.error(\"ОШИБКА: Файл не найден в запросе\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Файл не найден\"\n            }, {\n                status: 400\n            });\n        }\n        if (!file.name.toLowerCase().endsWith(\".docx\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Поддерживаются только файлы DOCX.\"\n            }, {\n                status: 400\n            });\n        }\n        if (file.size > 10 * 1024 * 1024) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Файл слишком большой (максимум 10MB)\"\n            }, {\n                status: 400\n            });\n        }\n        const arrayBuffer = await file.arrayBuffer();\n        let buffer = Buffer.from(arrayBuffer);\n        buffer = fillEmptyParagraphsInDocx(buffer);\n        let html;\n        try {\n            const { value } = await mammoth__WEBPACK_IMPORTED_MODULE_1__.convertToHtml({\n                buffer\n            });\n            html = value;\n        } catch (err) {\n            console.error(\"ОШИБКА: Не удалось конвертировать DOCX в HTML:\", err);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Ошибка конвертации DOCX в HTML: \" + String(err)\n            }, {\n                status: 500\n            });\n        }\n        let processedHtml;\n        try {\n            processedHtml = typographHtml(html);\n        } catch (err) {\n            console.error(\"ОШИБКА: Не удалось применить типографику к HTML:\", err);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Ошибка типографики по HTML: \" + String(err)\n            }, {\n                status: 500\n            });\n        }\n        const originalName = file.name.replace(/\\.docx$/i, \"\");\n        let fileNameTranslit = transliterate(originalName);\n        fileNameTranslit = fileNameTranslit.replace(/[^A-Za-z0-9_-]/g, \"_\").replace(/[_-]+$/, \"\");\n        if (output === \"html\") {\n            const encoder = new TextEncoder();\n            const htmlBuffer = encoder.encode(processedHtml);\n            const asciiFileName = fileNameTranslit;\n            const utf8FileName = `${fileNameTranslit}.html`;\n            console.log(\"УСПЕХ: Создан выходной HTML-файл:\", utf8FileName);\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(htmlBuffer, {\n                status: 200,\n                headers: {\n                    \"Content-Type\": \"text/html; charset=utf-8\",\n                    \"Content-Disposition\": `attachment; filename=\"${asciiFileName}.html\"; filename*=UTF-8''${encodeURIComponent(utf8FileName)}`,\n                    \"Content-Length\": htmlBuffer.length.toString(),\n                    \"Cache-Control\": \"no-cache, no-store, must-revalidate\",\n                    \"Pragma\": \"no-cache\",\n                    \"Expires\": \"0\"\n                }\n            });\n        }\n        // DOCX через docx\n        let docxBuffer;\n        try {\n            const doc = new docx__WEBPACK_IMPORTED_MODULE_4__.Document({\n                sections: [\n                    {\n                        properties: {},\n                        children: htmlToDocxParagraphs(processedHtml)\n                    }\n                ]\n            });\n            docxBuffer = await docx__WEBPACK_IMPORTED_MODULE_4__.Packer.toBuffer(doc);\n        } catch (err) {\n            console.error(\"ОШИБКА: Не удалось сгенерировать DOCX через docx:\", err);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Ошибка генерации DOCX: \" + String(err)\n            }, {\n                status: 500\n            });\n        }\n        const asciiFileName = fileNameTranslit;\n        const utf8FileName = `${fileNameTranslit}.docx`;\n        console.log(\"УСПЕХ: Создан выходной файл:\", utf8FileName);\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(docxBuffer, {\n            status: 200,\n            headers: {\n                \"Content-Type\": \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n                \"Content-Disposition\": `attachment; filename=\"${asciiFileName}.docx\"; filename*=UTF-8''${encodeURIComponent(utf8FileName)}`,\n                \"Content-Length\": docxBuffer.length.toString(),\n                \"Cache-Control\": \"no-cache, no-store, must-revalidate\",\n                \"Pragma\": \"no-cache\",\n                \"Expires\": \"0\"\n            }\n        });\n    } catch (error) {\n        console.error(\"ОШИБКА: Необработанная ошибка:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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REFBcURTO1lBQ25FLE9BQU83SyxxREFBWUEsQ0FBQ3FLLElBQUksQ0FBQztnQkFBRUQsT0FBTyw0QkFBNEJVLE9BQU9EO1lBQUssR0FBRztnQkFBRVAsUUFBUTtZQUFJO1FBQzdGO1FBQ0EsTUFBTWdCLGdCQUFnQkw7UUFDdEIsTUFBTU0sZUFBZSxDQUFDLEVBQUVOLGlCQUFpQixLQUFLLENBQUM7UUFDL0NuQixRQUFRQyxHQUFHLENBQUMsZ0NBQWdDd0I7UUFDNUMsT0FBTyxJQUFJdkwscURBQVlBLENBQUMyTCxZQUFZO1lBQ2xDckIsUUFBUTtZQUNSa0IsU0FBUztnQkFDUCxnQkFBZ0I7Z0JBQ2hCLHVCQUF1QixDQUFDLHNCQUFzQixFQUFFRixjQUFjLHlCQUF5QixFQUFFRyxtQkFBbUJGLGNBQWMsQ0FBQztnQkFDM0gsa0JBQWtCSSxXQUFXcEUsTUFBTSxDQUFDbUUsUUFBUTtnQkFDNUMsaUJBQWlCO2dCQUNqQixVQUFVO2dCQUNWLFdBQVc7WUFDYjtRQUNGO0lBQ0YsRUFBRSxPQUFPdEIsT0FBTztRQUNkTixRQUFRTSxLQUFLLENBQUMsa0NBQWtDQTtRQUNoRCxPQUFPcEsscURBQVlBLENBQUNxSyxJQUFJLENBQUM7WUFBRUQsT0FBT1UsT0FBT1Y7UUFBTyxHQUFHO1lBQUVFLFFBQVE7UUFBSTtJQUNuRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHlwb2dyYXBoeS1hcHAvLi9hcHAvYXBpL3Byb2Nlc3Mvcm91dGUudHM/MmUyYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IG1hbW1vdGggZnJvbSAnbWFtbW90aCc7XG5pbXBvcnQgKiBhcyBjaGVlcmlvIGZyb20gJ2NoZWVyaW8nO1xuaW1wb3J0IHsgdHlwb2dyYXBoVGV4dCB9IGZyb20gJ0AvbGliL3R5cG9ncmFwaHknO1xuaW1wb3J0IHsgRG9jdW1lbnQsIFBhY2tlciwgUGFyYWdyYXBoLCBUZXh0UnVuIH0gZnJvbSAnZG9jeCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBQaXpaaXAgZnJvbSAncGl6emlwJztcbmltcG9ydCB7IGxvYWQgYXMgbG9hZFhtbCB9IGZyb20gJ2NoZWVyaW8nO1xuXG5mdW5jdGlvbiB0eXBvZ3JhcGhIdG1sKGh0bWw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0ICQgPSBjaGVlcmlvLmxvYWQoaHRtbCk7XG4gICQoJ2JvZHksIGJvZHkgKicpLmNvbnRlbnRzKCkuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ3RleHQnKSB7XG4gICAgICB0aGlzLmRhdGEgPSB0eXBvZ3JhcGhUZXh0KHRoaXMuZGF0YSB8fCAnJyk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuICQuaHRtbCgpO1xufVxuXG5mdW5jdGlvbiB0cmFuc2xpdGVyYXRlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgbWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgINCQOiAnQScsINCROiAnQicsINCSOiAnVicsINCTOiAnRycsINCUOiAnRCcsINCVOiAnRScsINCBOiAnRScsINCWOiAnWmgnLCDQlzogJ1onLCDQmDogJ0knLCDQmTogJ1knLCDQmjogJ0snLCDQmzogJ0wnLCDQnDogJ00nLCDQnTogJ04nLCDQnjogJ08nLCDQnzogJ1AnLCDQoDogJ1InLCDQoTogJ1MnLCDQojogJ1QnLCDQozogJ1UnLCDQpDogJ0YnLCDQpTogJ0toJywg0KY6ICdUcycsINCnOiAnQ2gnLCDQqDogJ1NoJywg0Kk6ICdTaGNoJywg0Ko6ICcnLCDQqzogJ1knLCDQrDogJycsINCtOiAnRScsINCuOiAnWXUnLCDQrzogJ1lhJyxcbiAgICDQsDogJ2EnLCDQsTogJ2InLCDQsjogJ3YnLCDQszogJ2cnLCDQtDogJ2QnLCDQtTogJ2UnLCDRkTogJ2UnLCDQtjogJ3poJywg0Lc6ICd6Jywg0Lg6ICdpJywg0Lk6ICd5Jywg0Lo6ICdrJywg0Ls6ICdsJywg0Lw6ICdtJywg0L06ICduJywg0L46ICdvJywg0L86ICdwJywg0YA6ICdyJywg0YE6ICdzJywg0YI6ICd0Jywg0YM6ICd1Jywg0YQ6ICdmJywg0YU6ICdraCcsINGGOiAndHMnLCDRhzogJ2NoJywg0Yg6ICdzaCcsINGJOiAnc2hjaCcsINGKOiAnJywg0Ys6ICd5Jywg0Yw6ICcnLCDRjTogJ2UnLCDRjjogJ3l1Jywg0Y86ICd5YScsXG4gICAgJyAnOiAnXycsICfigJQnOiAnLScsICfigJMnOiAnLScsICcsJzogJycsICcuJzogJycsICfCqyc6ICcnLCAnwrsnOiAnJywgJygnOiAnJywgJyknOiAnJywgJ1snOiAnJywgJ10nOiAnJywgJ3snOiAnJywgJ30nOiAnJywgJy8nOiAnLScsICdcXFxcJzogJy0nLCAnQCc6ICdhdCcsICcjJzogJycsICckJzogJycsICclJzogJycsICdeJzogJycsICcmJzogJycsICcqJzogJycsICcrJzogJycsICc9JzogJycsICc6JzogJycsICc7JzogJycsICc/JzogJycsICchJzogJycsICdcIic6ICcnLCAnXFwnJzogJycsICc8JzogJycsICc+JzogJycsICd8JzogJycsICdgJzogJycsICd+JzogJydcbiAgfTtcbiAgcmV0dXJuIHN0ci5zcGxpdCgnJykubWFwKGNoYXIgPT4gbWFwW2NoYXJdICE9PSB1bmRlZmluZWQgPyBtYXBbY2hhcl0gOiBjaGFyKS5qb2luKCcnKTtcbn1cblxuZnVuY3Rpb24gcGFyc2VSdW5zKCQ6IGNoZWVyaW8uQ2hlZXJpb0FQSSwgJGVsZW06IGNoZWVyaW8uQ2hlZXJpbywgcGFyZW50U3R5bGU6IGFueSA9IHt9KTogVGV4dFJ1bltdIHtcbiAgY29uc3QgcnVuczogVGV4dFJ1bltdID0gW107XG4gICRlbGVtLmNvbnRlbnRzKCkuZWFjaCgoXywgbm9kZSkgPT4ge1xuICAgIGxldCBzdHlsZSA9IHsgLi4ucGFyZW50U3R5bGUgfTtcbiAgICBpZiAobm9kZS50eXBlID09PSAndGFnJykge1xuICAgICAgaWYgKG5vZGUubmFtZSA9PT0gJ2InIHx8IG5vZGUubmFtZSA9PT0gJ3N0cm9uZycpIHN0eWxlLmJvbGQgPSB0cnVlO1xuICAgICAgaWYgKG5vZGUubmFtZSA9PT0gJ2knIHx8IG5vZGUubmFtZSA9PT0gJ2VtJykgc3R5bGUuaXRhbGljcyA9IHRydWU7XG4gICAgICBpZiAobm9kZS5uYW1lID09PSAndScpIHN0eWxlLnVuZGVybGluZSA9IHt9O1xuICAgICAgaWYgKG5vZGUubmFtZSA9PT0gJ3NwYW4nICYmIG5vZGUuYXR0cmlicyAmJiBub2RlLmF0dHJpYnMuc3R5bGUpIHtcbiAgICAgICAgY29uc3QgcyA9IG5vZGUuYXR0cmlicy5zdHlsZTtcbiAgICAgICAgY29uc3QgY29sb3JNYXRjaCA9IHMubWF0Y2goL2NvbG9yOlxccyooW147XSspL2kpO1xuICAgICAgICBpZiAoY29sb3JNYXRjaCkgc3R5bGUuY29sb3IgPSBjb2xvck1hdGNoWzFdLnJlcGxhY2UoJyMnLCAnJyk7XG4gICAgICAgIGNvbnN0IHNpemVNYXRjaCA9IHMubWF0Y2goL2ZvbnQtc2l6ZTpcXHMqKFxcZCspcHgvaSk7XG4gICAgICAgIGlmIChzaXplTWF0Y2gpIHN0eWxlLnNpemUgPSBOdW1iZXIoc2l6ZU1hdGNoWzFdKSAqIDI7XG4gICAgICB9XG4gICAgICBydW5zLnB1c2goLi4ucGFyc2VSdW5zKCQsICQobm9kZSksIHN0eWxlKSk7XG4gICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICd0ZXh0Jykge1xuICAgICAgaWYgKG5vZGUuZGF0YSAmJiBub2RlLmRhdGEudHJpbSgpKSB7XG4gICAgICAgIHJ1bnMucHVzaChuZXcgVGV4dFJ1bih7IHRleHQ6IG5vZGUuZGF0YSwgLi4uc3R5bGUgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHJldHVybiBydW5zO1xufVxuXG5mdW5jdGlvbiBpc0VtcHR5UGFyYWdyYXBoKHBhcmFncmFwaDogYW55KTogYm9vbGVhbiB7XG4gIC8vINCS0LDRgNC40LDQvdGCINGBIHJvb3QgKGRvY3ggPj0gNylcbiAgaWYgKEFycmF5LmlzQXJyYXkocGFyYWdyYXBoLnJvb3QpICYmIHBhcmFncmFwaC5yb290Lmxlbmd0aCA+IDEpIHtcbiAgICBjb25zdCB0ZXh0UnVuID0gcGFyYWdyYXBoLnJvb3RbMV07XG4gICAgaWYgKHRleHRSdW4gJiYgQXJyYXkuaXNBcnJheSh0ZXh0UnVuLnJvb3QpICYmIHRleHRSdW4ucm9vdC5sZW5ndGggPiAxKSB7XG4gICAgICBjb25zdCB0ZXh0VmFsdWUgPSB0ZXh0UnVuLnJvb3RbMV07XG4gICAgICByZXR1cm4gdGV4dFZhbHVlID09PSAnICcgfHwgdGV4dFZhbHVlID09PSAnXFx1MDBBMCcgfHwgdGV4dFZhbHVlID09PSAnJm5ic3A7JztcbiAgICB9XG4gIH1cbiAgLy8g0KHRgtCw0YDRi9C1INCy0LDRgNC40LDQvdGC0YsgKNC90LAg0LLRgdGP0LrQuNC5INGB0LvRg9GH0LDQuSlcbiAgaWYgKHBhcmFncmFwaC5jaGlsZHJlbiAmJiBwYXJhZ3JhcGguY2hpbGRyZW4ubGVuZ3RoID09PSAxKSB7XG4gICAgY29uc3QgdCA9IHBhcmFncmFwaC5jaGlsZHJlblswXTtcbiAgICBjb25zdCB0ZXh0ID0gdC50ZXh0IHx8ICh0LnJvb3QgJiYgdC5yb290LnRleHQpO1xuICAgIHJldHVybiB0ZXh0ID09PSAnXFx1MDBBMCcgfHwgdGV4dCA9PT0gJyZuYnNwOycgfHwgdGV4dCA9PT0gJyAnO1xuICB9XG4gIGlmIChwYXJhZ3JhcGgub3B0aW9ucz8udGV4dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHBhcmFncmFwaC5vcHRpb25zLnRleHQgPT09ICdcXHUwMEEwJyB8fCBwYXJhZ3JhcGgub3B0aW9ucy50ZXh0ID09PSAnJm5ic3A7JyB8fCBwYXJhZ3JhcGgub3B0aW9ucy50ZXh0ID09PSAnICc7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBoYXNTaWduaWZpY2FudENvbnRlbnQocGFyYWdyYXBoOiBhbnkpOiBib29sZWFuIHtcbiAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8IHJvb3QgKGRvY3ggPj0gNylcbiAgaWYgKEFycmF5LmlzQXJyYXkocGFyYWdyYXBoLnJvb3QpICYmIHBhcmFncmFwaC5yb290Lmxlbmd0aCA+IDEpIHtcbiAgICBjb25zdCB0ZXh0UnVuID0gcGFyYWdyYXBoLnJvb3RbMV07XG4gICAgaWYgKHRleHRSdW4gJiYgQXJyYXkuaXNBcnJheSh0ZXh0UnVuLnJvb3QpICYmIHRleHRSdW4ucm9vdC5sZW5ndGggPiAxKSB7XG4gICAgICBjb25zdCB0ZXh0VmFsdWUgPSB0ZXh0UnVuLnJvb3RbMV07XG4gICAgICAvLyDQodGH0LjRgtCw0LXQvCDQt9C90LDRh9C40LzRi9C8INGC0L7Qu9GM0LrQviDQtdGB0LvQuCDQtdGB0YLRjCDQsdGD0LrQstCwINC40LvQuCDRhtC40YTRgNCwXG4gICAgICByZXR1cm4gL1tBLVphLXrQkC3Qr9CwLdGP0IHRkTAtOV0vLnRlc3QodGV4dFZhbHVlKTtcbiAgICB9XG4gIH1cbiAgLy8g0KHRgtCw0YDRi9C1INCy0LDRgNC40LDQvdGC0YsgKNC90LAg0LLRgdGP0LrQuNC5INGB0LvRg9GH0LDQuSlcbiAgaWYgKHBhcmFncmFwaC5jaGlsZHJlbiAmJiBwYXJhZ3JhcGguY2hpbGRyZW4ubGVuZ3RoID09PSAxKSB7XG4gICAgY29uc3QgdCA9IHBhcmFncmFwaC5jaGlsZHJlblswXTtcbiAgICBjb25zdCB0ZXh0ID0gdC50ZXh0IHx8ICh0LnJvb3QgJiYgdC5yb290LnRleHQpO1xuICAgIHJldHVybiAvW0EtWmEtetCQLdCv0LAt0Y/QgdGRMC05XS8udGVzdCh0ZXh0KTtcbiAgfVxuICBpZiAocGFyYWdyYXBoLm9wdGlvbnM/LnRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiAvW0EtWmEtetCQLdCv0LAt0Y/QgdGRMC05XS8udGVzdChwYXJhZ3JhcGgub3B0aW9ucy50ZXh0KTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGlzVHJ1bHlFbXB0eVBhcmFncmFwaChwYXJhZ3JhcGg6IGFueSk6IGJvb2xlYW4ge1xuICAvLyDQn9GA0L7QstC10YDRj9C10Lwgcm9vdCAoZG9jeCA+PSA3KVxuICBpZiAoQXJyYXkuaXNBcnJheShwYXJhZ3JhcGgucm9vdCkgJiYgcGFyYWdyYXBoLnJvb3QubGVuZ3RoID4gMSkge1xuICAgIGNvbnN0IHRleHRSdW4gPSBwYXJhZ3JhcGgucm9vdFsxXTtcbiAgICBpZiAodGV4dFJ1biAmJiBBcnJheS5pc0FycmF5KHRleHRSdW4ucm9vdCkgJiYgdGV4dFJ1bi5yb290Lmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnN0IHRleHRWYWx1ZSA9IHRleHRSdW4ucm9vdFsxXTtcbiAgICAgIHJldHVybiB0ZXh0VmFsdWUgPT09ICcgJyB8fCB0ZXh0VmFsdWUgPT09ICdcXHUwMEEwJyB8fCB0ZXh0VmFsdWUgPT09ICcmbmJzcDsnO1xuICAgIH1cbiAgfVxuICAvLyDQodGC0LDRgNGL0LUg0LLQsNGA0LjQsNC90YLRiyAo0L3QsCDQstGB0Y/QutC40Lkg0YHQu9GD0YfQsNC5KVxuICBpZiAocGFyYWdyYXBoLmNoaWxkcmVuICYmIHBhcmFncmFwaC5jaGlsZHJlbi5sZW5ndGggPT09IDEpIHtcbiAgICBjb25zdCB0ID0gcGFyYWdyYXBoLmNoaWxkcmVuWzBdO1xuICAgIGNvbnN0IHRleHQgPSB0LnRleHQgfHwgKHQucm9vdCAmJiB0LnJvb3QudGV4dCk7XG4gICAgcmV0dXJuIHRleHQgPT09ICdcXHUwMEEwJyB8fCB0ZXh0ID09PSAnJm5ic3A7JyB8fCB0ZXh0ID09PSAnICc7XG4gIH1cbiAgaWYgKHBhcmFncmFwaC5vcHRpb25zPy50ZXh0ICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gcGFyYWdyYXBoLm9wdGlvbnMudGV4dCA9PT0gJ1xcdTAwQTAnIHx8IHBhcmFncmFwaC5vcHRpb25zLnRleHQgPT09ICcmbmJzcDsnIHx8IHBhcmFncmFwaC5vcHRpb25zLnRleHQgPT09ICcgJztcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHRyaW1UcmFpbGluZ0VtcHR5UGFyYWdyYXBocyhwYXJhZ3JhcGhzOiBhbnlbXSk6IGFueVtdIHtcbiAgbGV0IGxhc3ROb25FbXB0eSA9IHBhcmFncmFwaHMubGVuZ3RoIC0gMTtcbiAgZm9yICg7IGxhc3ROb25FbXB0eSA+PSAwOyBsYXN0Tm9uRW1wdHktLSkge1xuICAgIGlmICghaXNUcnVseUVtcHR5UGFyYWdyYXBoKHBhcmFncmFwaHNbbGFzdE5vbkVtcHR5XSkpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyYWdyYXBocy5zbGljZSgwLCBsYXN0Tm9uRW1wdHkgKyAxKTtcbn1cblxuZnVuY3Rpb24gaHRtbFRvRG9jeFBhcmFncmFwaHMoaHRtbDogc3RyaW5nKTogUGFyYWdyYXBoW10ge1xuICBjb25zdCAkID0gY2hlZXJpby5sb2FkKGh0bWwpO1xuICBjb25zdCBwYXJhZ3JhcGhzOiBQYXJhZ3JhcGhbXSA9IFtdO1xuICBsZXQgcHJldldhc0Jsb2NrID0gZmFsc2U7XG4gICQoJ2JvZHknKS5jb250ZW50cygpLmVhY2goKF8sIGVsZW0pID0+IHtcbiAgICBpZiAoZWxlbS50eXBlID09PSAndGFnJykge1xuICAgICAgaWYgKGVsZW0udGFnTmFtZSA9PT0gJ3AnIHx8IGVsZW0udGFnTmFtZSA9PT0gJ2RpdicpIHtcbiAgICAgICAgY29uc3QgaW5uZXJIdG1sID0gJChlbGVtKS5odG1sKCk/LnJlcGxhY2UoL1xcc3wmbmJzcDt8PGJyXFxzKlxcLz8+KD89XFxzKjxcXC9wPikvZ2ksICcnKS50cmltKCk7XG4gICAgICAgIGlmICghaW5uZXJIdG1sKSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5wdXNoKG5ldyBQYXJhZ3JhcGgoJ1xcdTAwQTAnKSk7XG4gICAgICAgICAgcHJldldhc0Jsb2NrID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBydW5zID0gcGFyc2VSdW5zKCQsICQoZWxlbSkpO1xuICAgICAgICAgIGlmIChydW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgcGFyYWdyYXBocy5wdXNoKG5ldyBQYXJhZ3JhcGgoeyBjaGlsZHJlbjogcnVucyB9KSk7XG4gICAgICAgICAgICBwcmV2V2FzQmxvY2sgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gobmV3IFBhcmFncmFwaCgnXFx1MDBBMCcpKTtcbiAgICAgICAgICAgIHByZXZXYXNCbG9jayA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGVsZW0udGFnTmFtZSA9PT0gJ2JyJykge1xuICAgICAgICBwYXJhZ3JhcGhzLnB1c2gobmV3IFBhcmFncmFwaCgnXFx1MDBBMCcpKTtcbiAgICAgICAgcHJldldhc0Jsb2NrID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAoZWxlbS50YWdOYW1lID09PSAndWwnIHx8IGVsZW0udGFnTmFtZSA9PT0gJ29sJykge1xuICAgICAgICAkKGVsZW0pLmZpbmQoJ2xpJykuZWFjaCgoXywgbGkpID0+IHtcbiAgICAgICAgICBjb25zdCBydW5zID0gcGFyc2VSdW5zKCQsICQobGkpKTtcbiAgICAgICAgICBpZiAocnVucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHBhcmFncmFwaHMucHVzaChuZXcgUGFyYWdyYXBoKHsgY2hpbGRyZW46IHJ1bnMsIGJ1bGxldDogZWxlbS50YWdOYW1lID09PSAndWwnIH0pKTtcbiAgICAgICAgICAgIHByZXZXYXNCbG9jayA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoZWxlbS50YWdOYW1lID09PSAnaDEnIHx8IGVsZW0udGFnTmFtZSA9PT0gJ2gyJyB8fCBlbGVtLnRhZ05hbWUgPT09ICdoMycpIHtcbiAgICAgICAgY29uc3QgcnVucyA9IHBhcnNlUnVucygkLCAkKGVsZW0pKTtcbiAgICAgICAgaWYgKHJ1bnMubGVuZ3RoKSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5wdXNoKG5ldyBQYXJhZ3JhcGgoeyBjaGlsZHJlbjogcnVucywgaGVhZGluZzogZWxlbS50YWdOYW1lLnRvVXBwZXJDYXNlKCkgYXMgYW55IH0pKTtcbiAgICAgICAgICBwcmV2V2FzQmxvY2sgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChlbGVtLnR5cGUgPT09ICd0ZXh0Jykge1xuICAgICAgaWYgKGVsZW0uZGF0YSAmJiBlbGVtLmRhdGEucmVwbGFjZSgvXFxzKy9nLCAnJykgPT09ICcnKSB7XG4gICAgICAgIGlmIChwcmV2V2FzQmxvY2spIHtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gobmV3IFBhcmFncmFwaCgnXFx1MDBBMCcpKTtcbiAgICAgICAgICBwcmV2V2FzQmxvY2sgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIC8vINCj0LTQsNC70Y/QtdC8INGC0L7Qu9GM0LrQviDRhdCy0L7RgdGCINC40LcgdHJ1bHkgZW1wdHkg0LDQsdC30LDRhtC10LJcbiAgcmV0dXJuIHRyaW1UcmFpbGluZ0VtcHR5UGFyYWdyYXBocyhwYXJhZ3JhcGhzKTtcbn1cblxuLy8g0KTRg9C90LrRhtC40Y8g0LDQstGC0L7Qt9Cw0L/QvtC70L3QtdC90LjRjyDQv9GD0YHRgtGL0YUg0LDQsdC30LDRhtC10LIgRE9DWFxuZnVuY3Rpb24gZmlsbEVtcHR5UGFyYWdyYXBoc0luRG9jeChidWZmZXI6IEJ1ZmZlcik6IEJ1ZmZlciB7XG4gIGNvbnN0IHppcCA9IG5ldyBQaXpaaXAoYnVmZmVyKTtcbiAgbGV0IHhtbCA9IHppcC5maWxlKCd3b3JkL2RvY3VtZW50LnhtbCcpPy5hc1RleHQoKTtcbiAgaWYgKCF4bWwpIHJldHVybiBidWZmZXI7XG4gIGNvbnN0ICQgPSBsb2FkWG1sKHhtbCwgeyB4bWxNb2RlOiB0cnVlIH0pO1xuICAkKCcqJykuZWFjaCgoXywgcCkgPT4ge1xuICAgIGlmIChwLnRhZ05hbWUgPT09ICd3OnAnKSB7XG4gICAgICBjb25zdCBoYXNUZXh0ID0gJChwKS5maW5kKCd3XFxcXDp0LCB0JykuZmlsdGVyKChfLCB0KSA9PiAkKHQpLnRleHQoKS50cmltKCkgIT09ICcnKS5sZW5ndGggPiAwO1xuICAgICAgaWYgKCFoYXNUZXh0KSB7XG4gICAgICAgIGNvbnN0IHJ1biA9ICQoJzx3OnI+PHc6dCB4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiPiYjMTYwOzwvdzp0PjwvdzpyPicpO1xuICAgICAgICAkKHApLmFwcGVuZChydW4pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGNvbnN0IG5ld1htbCA9ICQueG1sKCk7XG4gIHppcC5maWxlKCd3b3JkL2RvY3VtZW50LnhtbCcsIG5ld1htbCk7XG4gIHJldHVybiB6aXAuZ2VuZXJhdGUoeyB0eXBlOiAnbm9kZWJ1ZmZlcicgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJz09PSDQndCQ0KfQkNCb0J4g0J7QkdCg0JDQkdCe0KLQmtCYINCk0JDQmdCb0JAgKEhUTUwt0L/RgNC+0YbQtdGB0YHQuNC90LMpID09PScpO1xuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpO1xuICAgIGNvbnN0IGZpbGUgPSBmb3JtRGF0YS5nZXQoJ2ZpbGUnKSBhcyBGaWxlO1xuICAgIGNvbnN0IG91dHB1dCA9IChmb3JtRGF0YS5nZXQoJ291dHB1dCcpIGFzIHN0cmluZyk/LnRvTG93ZXJDYXNlKCkgfHwgJ2RvY3gnO1xuICAgIGlmICghZmlsZSkge1xuICAgICAgY29uc29sZS5lcnJvcign0J7QqNCY0JHQmtCQOiDQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvSDQsiDQt9Cw0L/RgNC+0YHQtScpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvScgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG4gICAgaWYgKCFmaWxlLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aCgnLmRvY3gnKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICfQn9C+0LTQtNC10YDQttC40LLQsNGO0YLRgdGPINGC0L7Qu9GM0LrQviDRhNCw0LnQu9GLIERPQ1guJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cbiAgICBpZiAoZmlsZS5zaXplID4gMTAgKiAxMDI0ICogMTAyNCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICfQpNCw0LnQuyDRgdC70LjRiNC60L7QvCDQsdC+0LvRjNGI0L7QuSAo0LzQsNC60YHQuNC80YPQvCAxME1CKScgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG4gICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKCk7XG4gICAgbGV0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyKTtcbiAgICBidWZmZXIgPSBmaWxsRW1wdHlQYXJhZ3JhcGhzSW5Eb2N4KGJ1ZmZlcik7XG4gICAgbGV0IGh0bWw6IHN0cmluZztcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gYXdhaXQgbWFtbW90aC5jb252ZXJ0VG9IdG1sKHsgYnVmZmVyIH0pO1xuICAgICAgaHRtbCA9IHZhbHVlO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcign0J7QqNCY0JHQmtCQOiDQndC1INGD0LTQsNC70L7RgdGMINC60L7QvdCy0LXRgNGC0LjRgNC+0LLQsNGC0YwgRE9DWCDQsiBIVE1MOicsIGVycik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ9Ce0YjQuNCx0LrQsCDQutC+0L3QstC10YDRgtCw0YbQuNC4IERPQ1gg0LIgSFRNTDogJyArIFN0cmluZyhlcnIpIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxuICAgIGxldCBwcm9jZXNzZWRIdG1sOiBzdHJpbmc7XG4gICAgdHJ5IHtcbiAgICAgIHByb2Nlc3NlZEh0bWwgPSB0eXBvZ3JhcGhIdG1sKGh0bWwpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcign0J7QqNCY0JHQmtCQOiDQndC1INGD0LTQsNC70L7RgdGMINC/0YDQuNC80LXQvdC40YLRjCDRgtC40L/QvtCz0YDQsNGE0LjQutGDINC6IEhUTUw6JywgZXJyKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAn0J7RiNC40LHQutCwINGC0LjQv9C+0LPRgNCw0YTQuNC60Lgg0L/QviBIVE1MOiAnICsgU3RyaW5nKGVycikgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG4gICAgY29uc3Qgb3JpZ2luYWxOYW1lID0gZmlsZS5uYW1lLnJlcGxhY2UoL1xcLmRvY3gkL2ksICcnKTtcbiAgICBsZXQgZmlsZU5hbWVUcmFuc2xpdCA9IHRyYW5zbGl0ZXJhdGUob3JpZ2luYWxOYW1lKTtcbiAgICBmaWxlTmFtZVRyYW5zbGl0ID0gZmlsZU5hbWVUcmFuc2xpdC5yZXBsYWNlKC9bXkEtWmEtejAtOV8tXS9nLCAnXycpLnJlcGxhY2UoL1tfLV0rJC8sICcnKTtcbiAgICBpZiAob3V0cHV0ID09PSAnaHRtbCcpIHtcbiAgICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICAgIGNvbnN0IGh0bWxCdWZmZXIgPSBlbmNvZGVyLmVuY29kZShwcm9jZXNzZWRIdG1sKTtcbiAgICAgIGNvbnN0IGFzY2lpRmlsZU5hbWUgPSBmaWxlTmFtZVRyYW5zbGl0O1xuICAgICAgY29uc3QgdXRmOEZpbGVOYW1lID0gYCR7ZmlsZU5hbWVUcmFuc2xpdH0uaHRtbGA7XG4gICAgICBjb25zb2xlLmxvZygn0KPQodCf0JXQpTog0KHQvtC30LTQsNC9INCy0YvRhdC+0LTQvdC+0LkgSFRNTC3RhNCw0LnQuzonLCB1dGY4RmlsZU5hbWUpO1xuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoaHRtbEJ1ZmZlciwge1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgICAgICAnQ29udGVudC1EaXNwb3NpdGlvbic6IGBhdHRhY2htZW50OyBmaWxlbmFtZT1cIiR7YXNjaWlGaWxlTmFtZX0uaHRtbFwiOyBmaWxlbmFtZSo9VVRGLTgnJyR7ZW5jb2RlVVJJQ29tcG9uZW50KHV0ZjhGaWxlTmFtZSl9YCxcbiAgICAgICAgICAnQ29udGVudC1MZW5ndGgnOiBodG1sQnVmZmVyLmxlbmd0aC50b1N0cmluZygpLFxuICAgICAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlLCBuby1zdG9yZSwgbXVzdC1yZXZhbGlkYXRlJyxcbiAgICAgICAgICAnUHJhZ21hJzogJ25vLWNhY2hlJyxcbiAgICAgICAgICAnRXhwaXJlcyc6ICcwJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBET0NYINGH0LXRgNC10LcgZG9jeFxuICAgIGxldCBkb2N4QnVmZmVyOiBCdWZmZXI7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRvYyA9IG5ldyBEb2N1bWVudCh7XG4gICAgICAgIHNlY3Rpb25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgcHJvcGVydGllczoge30sXG4gICAgICAgICAgICBjaGlsZHJlbjogaHRtbFRvRG9jeFBhcmFncmFwaHMocHJvY2Vzc2VkSHRtbCksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgICAgZG9jeEJ1ZmZlciA9IGF3YWl0IFBhY2tlci50b0J1ZmZlcihkb2MpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcign0J7QqNCY0JHQmtCQOiDQndC1INGD0LTQsNC70L7RgdGMINGB0LPQtdC90LXRgNC40YDQvtCy0LDRgtGMIERPQ1gg0YfQtdGA0LXQtyBkb2N4OicsIGVycik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ9Ce0YjQuNCx0LrQsCDQs9C10L3QtdGA0LDRhtC40LggRE9DWDogJyArIFN0cmluZyhlcnIpIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFzY2lpRmlsZU5hbWUgPSBmaWxlTmFtZVRyYW5zbGl0O1xuICAgIGNvbnN0IHV0ZjhGaWxlTmFtZSA9IGAke2ZpbGVOYW1lVHJhbnNsaXR9LmRvY3hgO1xuICAgIGNvbnNvbGUubG9nKCfQo9Ch0J/QldClOiDQodC+0LfQtNCw0L0g0LLRi9GF0L7QtNC90L7QuSDRhNCw0LnQuzonLCB1dGY4RmlsZU5hbWUpO1xuICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKGRvY3hCdWZmZXIsIHtcbiAgICAgIHN0YXR1czogMjAwLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLmRvY3VtZW50JyxcbiAgICAgICAgJ0NvbnRlbnQtRGlzcG9zaXRpb24nOiBgYXR0YWNobWVudDsgZmlsZW5hbWU9XCIke2FzY2lpRmlsZU5hbWV9LmRvY3hcIjsgZmlsZW5hbWUqPVVURi04Jycke2VuY29kZVVSSUNvbXBvbmVudCh1dGY4RmlsZU5hbWUpfWAsXG4gICAgICAgICdDb250ZW50LUxlbmd0aCc6IGRvY3hCdWZmZXIubGVuZ3RoLnRvU3RyaW5nKCksXG4gICAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlLCBuby1zdG9yZSwgbXVzdC1yZXZhbGlkYXRlJyxcbiAgICAgICAgJ1ByYWdtYSc6ICduby1jYWNoZScsXG4gICAgICAgICdFeHBpcmVzJzogJzAnLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfQntCo0JjQkdCa0JA6INCd0LXQvtCx0YDQsNCx0L7RgtCw0L3QvdCw0Y8g0L7RiNC40LHQutCwOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogU3RyaW5nKGVycm9yKSB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIm1hbW1vdGgiLCJjaGVlcmlvIiwidHlwb2dyYXBoVGV4dCIsIkRvY3VtZW50IiwiUGFja2VyIiwiUGFyYWdyYXBoIiwiVGV4dFJ1biIsIlBpelppcCIsImxvYWQiLCJsb2FkWG1sIiwidHlwb2dyYXBoSHRtbCIsImh0bWwiLCIkIiwiY29udGVudHMiLCJlYWNoIiwidHlwZSIsImRhdGEiLCJ0cmFuc2xpdGVyYXRlIiwic3RyIiwibWFwIiwi0JAiLCLQkSIsItCSIiwi0JMiLCLQlCIsItCVIiwi0IEiLCLQliIsItCXIiwi0JgiLCLQmSIsItCaIiwi0JsiLCLQnCIsItCdIiwi0J4iLCLQnyIsItCgIiwi0KEiLCLQoiIsItCjIiwi0KQiLCLQpSIsItCmIiwi0KciLCLQqCIsItCpIiwi0KoiLCLQqyIsItCsIiwi0K0iLCLQriIsItCvIiwi0LAiLCLQsSIsItCyIiwi0LMiLCLQtCIsItC1Iiwi0ZEiLCLQtiIsItC3Iiwi0LgiLCLQuSIsItC6Iiwi0LsiLCLQvCIsItC9Iiwi0L4iLCLQvyIsItGAIiwi0YEiLCLRgiIsItGDIiwi0YQiLCLRhSIsItGGIiwi0YciLCLRiCIsItGJIiwi0YoiLCLRiyIsItGMIiwi0Y0iLCLRjiIsItGPIiwic3BsaXQiLCJjaGFyIiwidW5kZWZpbmVkIiwiam9pbiIsInBhcnNlUnVucyIsIiRlbGVtIiwicGFyZW50U3R5bGUiLCJydW5zIiwiXyIsIm5vZGUiLCJzdHlsZSIsIm5hbWUiLCJib2xkIiwiaXRhbGljcyIsInVuZGVybGluZSIsImF0dHJpYnMiLCJzIiwiY29sb3JNYXRjaCIsIm1hdGNoIiwiY29sb3IiLCJyZXBsYWNlIiwic2l6ZU1hdGNoIiwic2l6ZSIsIk51bWJlciIsInB1c2giLCJ0cmltIiwidGV4dCIsImlzRW1wdHlQYXJhZ3JhcGgiLCJwYXJhZ3JhcGgiLCJBcnJheSIsImlzQXJyYXkiLCJyb290IiwibGVuZ3RoIiwidGV4dFJ1biIsInRleHRWYWx1ZSIsImNoaWxkcmVuIiwidCIsIm9wdGlvbnMiLCJoYXNTaWduaWZpY2FudENvbnRlbnQiLCJ0ZXN0IiwiaXNUcnVseUVtcHR5UGFyYWdyYXBoIiwidHJpbVRyYWlsaW5nRW1wdHlQYXJhZ3JhcGhzIiwicGFyYWdyYXBocyIsImxhc3ROb25FbXB0eSIsInNsaWNlIiwiaHRtbFRvRG9jeFBhcmFncmFwaHMiLCJwcmV2V2FzQmxvY2siLCJlbGVtIiwidGFnTmFtZSIsImlubmVySHRtbCIsImZpbmQiLCJsaSIsImJ1bGxldCIsImhlYWRpbmciLCJ0b1VwcGVyQ2FzZSIsImZpbGxFbXB0eVBhcmFncmFwaHNJbkRvY3giLCJidWZmZXIiLCJ6aXAiLCJ4bWwiLCJmaWxlIiwiYXNUZXh0IiwieG1sTW9kZSIsInAiLCJoYXNUZXh0IiwiZmlsdGVyIiwicnVuIiwiYXBwZW5kIiwibmV3WG1sIiwiZ2VuZXJhdGUiLCJQT1NUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJmb3JtRGF0YSIsImdldCIsIm91dHB1dCIsInRvTG93ZXJDYXNlIiwiZXJyb3IiLCJqc29uIiwic3RhdHVzIiwiZW5kc1dpdGgiLCJhcnJheUJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJ2YWx1ZSIsImNvbnZlcnRUb0h0bWwiLCJlcnIiLCJTdHJpbmciLCJwcm9jZXNzZWRIdG1sIiwib3JpZ2luYWxOYW1lIiwiZmlsZU5hbWVUcmFuc2xpdCIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsImh0bWxCdWZmZXIiLCJlbmNvZGUiLCJhc2NpaUZpbGVOYW1lIiwidXRmOEZpbGVOYW1lIiwiaGVhZGVycyIsImVuY29kZVVSSUNvbXBvbmVudCIsInRvU3RyaW5nIiwiZG9jeEJ1ZmZlciIsImRvYyIsInNlY3Rpb25zIiwicHJvcGVydGllcyIsInRvQnVmZmVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/process/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/typography.ts":
/*!***************************!*\
  !*** ./lib/typography.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AdvancedTypographyProcessor: () => (/* binding */ AdvancedTypographyProcessor),\n/* harmony export */   TypographyProcessor: () => (/* binding */ TypographyProcessor),\n/* harmony export */   typographText: () => (/* binding */ typographText)\n/* harmony export */ });\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cheerio */ \"(rsc)/./node_modules/cheerio/dist/esm/index.js\");\n\nclass AdvancedTypographyProcessor {\n    static{\n        this.NON_BREAKING_SPACE = \"\\xa0\";\n    }\n    static{\n        this.THIN_SPACE = \" \";\n    }\n    static{\n        this.EM_DASH = \"—\";\n    }\n    static{\n        this.ELLIPSIS = \"…\";\n    }\n    static{\n        this.EN_SPACE = \" \";\n    }\n    /**\n   * Определяет, является ли текст стихотворением\n   */ static isPoetry(text) {\n        const lines = text.split(\"\\n\").filter((line)=>line.trim().length > 0);\n        // Признаки стихотворения:\n        let poetryScore = 0;\n        // 1. Короткие строки (меньше 60 символов в среднем)\n        const avgLineLength = lines.reduce((sum, line)=>sum + line.trim().length, 0) / lines.length;\n        if (avgLineLength < 60) poetryScore += 2;\n        // 2. Много переносов строк\n        const lineBreaks = (text.match(/\\n/g) || []).length;\n        const wordCount = text.split(/\\s+/).length;\n        if (lineBreaks / wordCount > 0.1) poetryScore += 2;\n        // 3. Табуляции в начале строк (лесенка)\n        const indentedLines = lines.filter((line)=>line.match(/^\\s{2,}/) || line.startsWith(\"\t\")).length;\n        if (indentedLines / lines.length > 0.3) poetryScore += 3;\n        // 4. Заглавные буквы в начале строк\n        const capitalizedLines = lines.filter((line)=>/^[А-ЯЁA-Z]/.test(line.trim())).length;\n        if (capitalizedLines / lines.length > 0.7) poetryScore += 1;\n        // 5. Ритмичность (повторяющаяся длина строк)\n        const lineLengths = lines.map((line)=>line.trim().length);\n        const lengthVariance = this.calculateVariance(lineLengths);\n        if (lengthVariance < 100) poetryScore += 1;\n        return poetryScore >= 4;\n    }\n    /**\n   * Вычисляет дисперсию массива чисел\n   */ static calculateVariance(numbers) {\n        const mean = numbers.reduce((sum, num)=>sum + num, 0) / numbers.length;\n        const squaredDiffs = numbers.map((num)=>Math.pow(num - mean, 2));\n        return squaredDiffs.reduce((sum, diff)=>sum + diff, 0) / numbers.length;\n    }\n    /**\n   * Обрабатывает текст с сохранением форматирования\n   */ static processWithFormatting(paragraphs) {\n        const fullText = paragraphs.map((p)=>p.content.map((c)=>c.text).join(\"\")).join(\"\\n\");\n        const isPoetryText = this.isPoetry(fullText);\n        return paragraphs.map((paragraph)=>{\n            const processedContent = paragraph.content.map((item)=>({\n                    ...item,\n                    text: isPoetryText ? this.processPoetryText(item.text) : this.processRegularText(item.text)\n                }));\n            return {\n                ...paragraph,\n                content: processedContent,\n                style: isPoetryText && paragraph.style === \"normal\" ? \"poetry\" : paragraph.style\n            };\n        });\n    }\n    /**\n   * Обработка обычного текста\n   */ static processRegularText(text) {\n        let result = text;\n        // Основные правила типографики\n        result = this.applyBasicRules(result);\n        result = this.applyNonBreakingSpaces(result);\n        result = this.applyPunctuation(result);\n        // Удаляем все пустые строки в конце текста\n        result = result.replace(/(\\r?\\n)+$/g, \"\");\n        return result;\n    }\n    /**\n   * Обработка стихотворного текста с сохранением структуры\n   */ static processPoetryText(text) {\n        let result = text;\n        // Сохраняем табуляции и отступы\n        const lines = result.split(\"\\n\");\n        const processedLines = lines.map((line)=>{\n            // Сохраняем начальные пробелы и табуляции\n            const indent = line.match(/^[\\s\\t]*/)?.[0] || \"\";\n            const content = line.substring(indent.length);\n            if (content.trim().length === 0) {\n                return line; // Пустые строки не обрабатываем\n            }\n            // Обрабатываем только содержимое, сохраняя отступы\n            let processedContent = content;\n            // Мягкая обработка для стихов (меньше изменений)\n            processedContent = this.applyPoetryRules(processedContent);\n            return indent + processedContent;\n        });\n        return processedLines.join(\"\\n\");\n    }\n    /**\n   * Применяет базовые правила типографики\n   */ static applyBasicRules(text) {\n        let result = text;\n        // 0. Защита от слипания слов: временно заменяем > < на >\\u200B< (невидимый разделитель)\n        result = result.replace(/>\\s+</g, \">​<\");\n        // 1. Множественные пробелы (заменяем любые последовательности пробельных символов, кроме \\n, на один пробел)\n        result = result.replace(/[ \\t\\v\\f\\r]{2,}/g, \" \");\n        // 1a. Убираем пробелы в начале и конце каждой строки (но не трогаем внутренние пробелы между словами)\n        result = result.replace(/^[ \\t]+|[ \\t]+$/gm, \"\");\n        // 1b. Между знаком № и цифрой всегда неразрывный пробел\n        result = result.replace(/№\\s*(\\d+)/g, \"№\\xa0$1\");\n        // 2. Защита дефиса между буквами (буква-дефис-буква, сложные слова, фамилии, топонимы и т.д.)\n        result = result.replace(/(\\p{L})-(\\p{L})/gu, \"$1[[HYPHEN]]$2\");\n        // 3. Защита дефиса в сложных словах и наречиях\n        const hyphenWords = [\n            \"из-за\",\n            \"из-под\",\n            \"по-русски\",\n            \"по-моему\",\n            \"по-твоему\",\n            \"по-нашему\",\n            \"по-вашему\",\n            \"кое-что\",\n            \"кое-как\",\n            \"кто-нибудь\",\n            \"что-нибудь\",\n            \"где-нибудь\",\n            \"когда-либо\",\n            \"как-то\",\n            \"все-таки\",\n            \"по-своему\",\n            \"по-старому\",\n            \"по-новому\",\n            \"по-английски\",\n            \"по-французски\",\n            \"по-немецки\",\n            \"по-итальянски\",\n            \"по-испански\",\n            \"по-китайски\",\n            \"по-японски\",\n            \"по-украински\",\n            \"по-белорусски\",\n            \"по-польски\",\n            \"по-чешски\",\n            \"по-гречески\",\n            \"по-турецки\",\n            \"по-арабски\",\n            \"по-еврейски\",\n            \"по-латински\",\n            \"по-современному\",\n            \"по-старинному\",\n            \"по-детски\",\n            \"по-взрослому\",\n            \"по-товарищески\",\n            \"по-приятельски\",\n            \"по-родственному\",\n            \"по-отечески\",\n            \"по-матерински\",\n            \"по-братски\",\n            \"по-сестрински\",\n            \"по-деловому\",\n            \"по-дружески\",\n            \"по-особенному\",\n            \"по-особому\"\n        ];\n        hyphenWords.forEach((word)=>{\n            // Защищаем оба варианта: с \"е\" и с \"ё\" (например, всё-таки/все-таки)\n            const safe = word.replace(/-/g, \"[[HYPHEN]]\");\n            const regex = new RegExp(word.replace(\"е\", \"[её]\"), \"gi\");\n            result = result.replace(regex, safe);\n        });\n        // 4. Защита сокращений\n        result = result.replace(/\\bт\\.-е\\./gi, \"[[T_E]]\").replace(/\\bт\\.-д\\./gi, \"[[T_D]]\").replace(/\\bт\\.-п\\./gi, \"[[T_P]]\").replace(/\\bт\\.-к\\./gi, \"[[T_K]]\").replace(/\\bт\\.-н\\./gi, \"[[T_N]]\").replace(/\\bт\\.-о\\./gi, \"[[T_O]]\").replace(/\\bи\\ т\\.-д\\./gi, \"[[I_T_D]]\");\n        // 5. Диапазон чисел: 1966-1977 → 1966–1977 (en dash), без пробелов вокруг\n        result = result.replace(/(\\d{1,4})\\s*-\\s*(\\d{1,4})/g, \"$1–$2\");\n        // 5a. Удаляем пробелы вокруг en dash между числами (2020 - 2021 → 2020–2021)\n        result = result.replace(/(\\d{1,4})\\s*–\\s*(\\d{1,4})/g, \"$1–$2\");\n        // 6. en dash между словами или с пробелами → em dash с неразрывным пробелом\n        // (\\s|^)–(\\s) → \\u00A0— \n        result = result.replace(/(\\s|^|\\n)–(\\s)/g, \"$1\\xa0— \");\n        // Также: пробел en dash пробел\n        result = result.replace(/\\s+–\\s+/g, \"\\xa0— \");\n        // 7. Пробел-длинное тире-пробел и пробел-дефис-пробел → неразрывный пробел—обычный пробел\n        result = result.replace(/\\s+(-|—)\\s+/g, \"\\xa0— \");\n        // 8. Между словами (буква-пробел-дефис-пробел-буква)\n        // После тире всегда пробел\n        result = result.replace(/(\\p{L})\\s*-\\s*(\\p{L})/gu, \"$1 — $2\");\n        // После em dash/en dash между словами — всегда пробел, КРОМЕ диапазонов чисел\n        result = result.replace(/—(?!\\d)(\\S)/g, \"— $1\");\n        result = result.replace(/–(?!\\d)(\\S)/g, \"– $1\");\n        // 9. В начале строки (диалоги)\n        result = result.replace(/(^|\\n)-\\s/gu, \"$1— \");\n        // 10. Возвращаем сокращения, дефисы внутри слов и сложных слов\n        result = result.replace(/\\[\\[T_E\\]\\]/g, \"т.-е.\").replace(/\\[\\[T_D\\]\\]/g, \"т.-д.\").replace(/\\[\\[T_P\\]\\]/g, \"т.-п.\").replace(/\\[\\[T_K\\]\\]/g, \"т.-к.\").replace(/\\[\\[T_N\\]\\]/g, \"т.-н.\").replace(/\\[\\[T_O\\]\\]/g, \"т.-о.\").replace(/\\[\\[I_T_D\\]\\]/g, \"и т.д.\").replace(/\\[\\[HYPHEN\\]\\]/g, \"-\");\n        // 11. Замена трех точек на многоточие\n        result = result.replace(/\\.{3,}/g, this.ELLIPSIS);\n        // 12. Пробелы перед знаками препинания\n        result = result.replace(/\\s+([,.;:!?])/g, \"$1\");\n        // 13. Пробелы после знаков препинания\n        result = result.replace(/([,.;:!?])([А-Яа-яёЁA-Za-z])/g, \"$1 $2\");\n        // 14. Пробелы в скобках\n        result = result.replace(/\\(\\s+/g, \"(\");\n        result = result.replace(/\\s+\\)/g, \")\");\n        // В самом конце: нормализуем двойные пробелы до одного\n        result = result.replace(/ {2,}/g, \" \");\n        // 99. Восстанавливаем невидимый разделитель между тегами\n        result = result.replace(/\\u200B/g, \" \");\n        // После однобуквенных предлогов — неразрывный пробел (улучшенная регулярка)\n        result = result.replace(/(^|[\\s.,;:!?\"'«»()\\[\\]{}-])([вксуояи])\\s+([А-Яа-яA-Za-z])/gmu, \"$1$2\\xa0$3\");\n        // Между числом и словом — неразрывный пробел\n        result = result.replace(/(\\d)\\s+([А-Яа-яA-Za-z])/g, \"$1\\xa0$2\");\n        return result;\n    }\n    /**\n   * Применяет правила для стихотворений (более деликатно)\n   */ static applyPoetryRules(text) {\n        let result = text;\n        // Только основные правила, не трогаем структуру\n        result = result.replace(/--/g, this.EM_DASH);\n        result = result.replace(/\\.{3,}/g, this.ELLIPSIS);\n        // Осторожно с пробелами в стихах\n        result = result.replace(/\\s+([,.;:!?])/g, \"$1\");\n        result = result.replace(/([,.;:!?])([А-Яа-яёЁ])/g, \"$1 $2\");\n        return result;\n    }\n    /**\n   * Применяет неразрывные пробелы\n   */ static applyNonBreakingSpaces(text) {\n        let result = text;\n        // Короткие слова\n        const shortWords = [\n            \"а\",\n            \"в\",\n            \"и\",\n            \"к\",\n            \"о\",\n            \"с\",\n            \"у\",\n            \"не\",\n            \"на\",\n            \"от\",\n            \"до\",\n            \"за\",\n            \"из\",\n            \"по\",\n            \"со\",\n            \"во\",\n            \"об\"\n        ];\n        shortWords.forEach((word)=>{\n            const regex = new RegExp(`\\\\b${word}\\\\s+`, \"gi\");\n            result = result.replace(regex, word + this.NON_BREAKING_SPACE);\n        });\n        // Числа с единицами измерения\n        result = result.replace(/(\\d+)\\s+(кг|г|т|мг|мм|дм|см|м|км|л|мл|руб|коп|долл|евро)/gi, `$1${this.NON_BREAKING_SPACE}$2`);\n        // Инициалы с фамилией\n        result = result.replace(/([А-ЯЁ]\\.)\\s+([А-ЯЁ]\\.)\\s+([А-ЯЁ][а-яё]+)/g, `$1${this.NON_BREAKING_SPACE}$2${this.NON_BREAKING_SPACE}$3`);\n        return result;\n    }\n    /**\n   * Применяет правила пунктуации\n   */ static applyPunctuation(text) {\n        let result = text;\n        // Диалоги\n        result = result.replace(/^\\s*-\\s*/gm, this.EM_DASH + this.EN_SPACE);\n        // Проценты\n        result = result.replace(/(\\d+)\\s*%/g, `$1${this.THIN_SPACE}%`);\n        return result;\n    }\n    /**\n   * Определяет структуру четверостиший\n   */ static detectStanzaStructure(text) {\n        const lines = text.split(\"\\n\");\n        const stanzas = [];\n        let currentStanza = [];\n        let emptyLineCount = 0;\n        for (const line of lines){\n            if (line.trim().length === 0) {\n                emptyLineCount++;\n                if (emptyLineCount >= 1 && currentStanza.length > 0) {\n                    // Конец строфы\n                    stanzas.push(currentStanza.join(\"\\n\"));\n                    currentStanza = [];\n                    emptyLineCount = 0;\n                }\n            } else {\n                currentStanza.push(line);\n                emptyLineCount = 0;\n            }\n        }\n        // Добавляем последнюю строфу\n        if (currentStanza.length > 0) {\n            stanzas.push(currentStanza.join(\"\\n\"));\n        }\n        return stanzas;\n    }\n    /**\n   * Обрабатывает простой текст (для обратной совместимости)\n   */ static process(text) {\n        const isPoetryText = this.isPoetry(text);\n        if (isPoetryText) {\n            return this.processPoetryText(text);\n        } else {\n            return this.processRegularText(text);\n        }\n    }\n    /**\n   * Создает статистику обработки\n   */ static getProcessingStats(originalText, processedText) {\n        const isPoetryText = this.isPoetry(originalText);\n        return {\n            originalLength: originalText.length,\n            processedLength: processedText.length,\n            isPoetry: isPoetryText,\n            spacesReplaced: (originalText.match(/[ ]{2,}/g) || []).length,\n            dashesReplaced: (originalText.match(/--/g) || []).length,\n            ellipsisReplaced: (originalText.match(/\\.{3,}/g) || []).length,\n            stanzaCount: isPoetryText ? this.detectStanzaStructure(originalText).length : undefined\n        };\n    }\n    /**\n   * Получить пример текста (обновленный)\n   */ static getExampleText() {\n        return `Пример текста с   типографскими ошибками\n\nПроблемы  с   пробелами    и знаками   ,точками   .\nДефисы  --  вместо тире и многоточие...\nПлохие пробелы в скобках( вот так ).\n\nНеразрывные пробелы:\nВ магазин за хлебом.\nК врачу на осмотр.\nНа работу в офис.\nВес: 10 кг, рост: 180 см.\nА. С. Пушкин написал много произведений.\n\nДиалоги:\n- Привет! Как дела?\n- Хорошо, спасибо за вопрос.\n\nПроценты: скидка 15% на все товары.\n\nПРИМЕР СТИХОТВОРЕНИЯ:\n\n        Белеет парус одинокой\n        В тумане моря голубом...\n        Что ищет он в стране далекой?\n        Что кинул он в краю родном?\n\n    Играют волны -- ветер свищет,\n    И мачта гнется и скрыпит...\n        Увы! он счастия не ищет\n        И не от счастия бежит!\n\nПод ним струя светлей лазури,\nНад ним луч солнца золотой...\n    А он, мятежный, просит бури,\n    Как будто в бурях есть покой!\n\nЭтот текст содержит различные типографские ошибки и демонстрирует работу с поэзией.`;\n    }\n}\n// Экспорт для обратной совместимости\nconst TypographyProcessor = AdvancedTypographyProcessor;\nfunction typographText(text) {\n    return AdvancedTypographyProcessor.process(text);\n}\nfunction typographHtml(html) {\n    const $ = cheerio__WEBPACK_IMPORTED_MODULE_0__.load(html);\n    $(\"body, body *\").contents().each(function() {\n        // Если это текст внутри пустого <p> — не трогаем\n        if (this.type === \"text\") {\n            const parent = this.parent;\n            if (parent && parent.tagName === \"p\" && (!this.data || this.data.replace(/\\s|\\u00A0|&nbsp;/g, \"\") === \"\")) {\n                return;\n            }\n            this.data = typographText(this.data || \"\");\n        }\n    });\n    return $.html();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WTtJQUN4QyxPQUFPUCw0QkFBNEJ1RSxPQUFPLENBQUNoRTtBQUM3QztBQUVBLFNBQVM4RSxjQUFjQyxJQUFZO0lBQ2pDLE1BQU1DLElBQUl4Rix5Q0FBWSxDQUFDdUY7SUFDdkJDLEVBQUUsZ0JBQWdCRSxRQUFRLEdBQUdDLElBQUksQ0FBQztRQUNoQyxpREFBaUQ7UUFDakQsSUFBSSxJQUFJLENBQUNDLElBQUksS0FBSyxRQUFRO1lBQ3hCLE1BQU1DLFNBQVMsSUFBSSxDQUFDQSxNQUFNO1lBQzFCLElBQ0VBLFVBQ0FBLE9BQU9DLE9BQU8sS0FBSyxPQUNsQixFQUFDLElBQUksQ0FBQ0MsSUFBSSxJQUFJLElBQUksQ0FBQ0EsSUFBSSxDQUFDeEMsT0FBTyxDQUFDLHFCQUFxQixRQUFRLEVBQUMsR0FDL0Q7Z0JBQ0E7WUFDRjtZQUNBLElBQUksQ0FBQ3dDLElBQUksR0FBR1YsY0FBYyxJQUFJLENBQUNVLElBQUksSUFBSTtRQUN6QztJQUNGO0lBQ0EsT0FBT1AsRUFBRUQsSUFBSTtBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHlwb2dyYXBoeS1hcHAvLi9saWIvdHlwb2dyYXBoeS50cz80NmI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNoZWVyaW8gZnJvbSAnY2hlZXJpbyc7XG5cbi8vINCg0LDRgdGI0LjRgNC10L3QvdCw0Y8g0YLQuNC/0L7Qs9GA0LDRhNGB0LrQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCDRgSDRgdC+0YXRgNCw0L3QtdC90LjQtdC8INGE0L7RgNC80LDRgtC40YDQvtCy0LDQvdC40Y9cbmV4cG9ydCBpbnRlcmZhY2UgRm9ybWF0dGVkVGV4dCB7XG4gIHRleHQ6IHN0cmluZztcbiAgYm9sZD86IGJvb2xlYW47XG4gIGl0YWxpYz86IGJvb2xlYW47XG4gIHVuZGVybGluZT86IGJvb2xlYW47XG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICBjb2xvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGb3JtYXR0ZWRQYXJhZ3JhcGgge1xuICBjb250ZW50OiBGb3JtYXR0ZWRUZXh0W107XG4gIHN0eWxlPzogJ25vcm1hbCcgfCAnaGVhZGluZzEnIHwgJ2hlYWRpbmcyJyB8ICdwb2V0cnknIHwgJ3F1b3RlJztcbiAgYWxpZ25tZW50PzogJ2xlZnQnIHwgJ2NlbnRlcicgfCAncmlnaHQnIHwgJ2p1c3RpZnknO1xuICBpbmRlbnQ/OiBudW1iZXI7XG4gIHRhYlN0b3BzPzogbnVtYmVyW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvY2Vzc2VkRG9jdW1lbnQge1xuICBwYXJhZ3JhcGhzOiBGb3JtYXR0ZWRQYXJhZ3JhcGhbXTtcbiAgbWV0YWRhdGE6IHtcbiAgICBpc1BvZXRyeTogYm9vbGVhbjtcbiAgICBoYXNGb3JtYXR0aW5nOiBib29sZWFuO1xuICAgIG9yaWdpbmFsTGVuZ3RoOiBudW1iZXI7XG4gICAgcHJvY2Vzc2VkTGVuZ3RoOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBBZHZhbmNlZFR5cG9ncmFwaHlQcm9jZXNzb3Ige1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBOT05fQlJFQUtJTkdfU1BBQ0UgPSAnXFx1MDBBMCc7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFRISU5fU1BBQ0UgPSAnXFx1MjAwOSc7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEVNX0RBU0ggPSAn4oCUJztcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRUxMSVBTSVMgPSAn4oCmJztcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRU5fU1BBQ0UgPSAnXFx1MjAwMic7XG5cbiAgLyoqXG4gICAqINCe0L/RgNC10LTQtdC70Y/QtdGCLCDRj9Cy0LvRj9C10YLRgdGPINC70Lgg0YLQtdC60YHRgiDRgdGC0LjRhdC+0YLQstC+0YDQtdC90LjQtdC8XG4gICAqL1xuICBzdGF0aWMgaXNQb2V0cnkodGV4dDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKS5sZW5ndGggPiAwKTtcbiAgICBcbiAgICAvLyDQn9GA0LjQt9C90LDQutC4INGB0YLQuNGF0L7RgtCy0L7RgNC10L3QuNGPOlxuICAgIGxldCBwb2V0cnlTY29yZSA9IDA7XG4gICAgXG4gICAgLy8gMS4g0JrQvtGA0L7RgtC60LjQtSDRgdGC0YDQvtC60LggKNC80LXQvdGM0YjQtSA2MCDRgdC40LzQstC+0LvQvtCyINCyINGB0YDQtdC00L3QtdC8KVxuICAgIGNvbnN0IGF2Z0xpbmVMZW5ndGggPSBsaW5lcy5yZWR1Y2UoKHN1bSwgbGluZSkgPT4gc3VtICsgbGluZS50cmltKCkubGVuZ3RoLCAwKSAvIGxpbmVzLmxlbmd0aDtcbiAgICBpZiAoYXZnTGluZUxlbmd0aCA8IDYwKSBwb2V0cnlTY29yZSArPSAyO1xuICAgIFxuICAgIC8vIDIuINCc0L3QvtCz0L4g0L/QtdGA0LXQvdC+0YHQvtCyINGB0YLRgNC+0LpcbiAgICBjb25zdCBsaW5lQnJlYWtzID0gKHRleHQubWF0Y2goL1xcbi9nKSB8fCBbXSkubGVuZ3RoO1xuICAgIGNvbnN0IHdvcmRDb3VudCA9IHRleHQuc3BsaXQoL1xccysvKS5sZW5ndGg7XG4gICAgaWYgKGxpbmVCcmVha3MgLyB3b3JkQ291bnQgPiAwLjEpIHBvZXRyeVNjb3JlICs9IDI7XG4gICAgXG4gICAgLy8gMy4g0KLQsNCx0YPQu9GP0YbQuNC4INCyINC90LDRh9Cw0LvQtSDRgdGC0YDQvtC6ICjQu9C10YHQtdC90LrQsClcbiAgICBjb25zdCBpbmRlbnRlZExpbmVzID0gbGluZXMuZmlsdGVyKGxpbmUgPT4gbGluZS5tYXRjaCgvXlxcc3syLH0vKSB8fCBsaW5lLnN0YXJ0c1dpdGgoJ1xcdCcpKS5sZW5ndGg7XG4gICAgaWYgKGluZGVudGVkTGluZXMgLyBsaW5lcy5sZW5ndGggPiAwLjMpIHBvZXRyeVNjb3JlICs9IDM7XG4gICAgXG4gICAgLy8gNC4g0JfQsNCz0LvQsNCy0L3Ri9C1INCx0YPQutCy0Ysg0LIg0L3QsNGH0LDQu9C1INGB0YLRgNC+0LpcbiAgICBjb25zdCBjYXBpdGFsaXplZExpbmVzID0gbGluZXMuZmlsdGVyKGxpbmUgPT4gL15b0JAt0K/QgUEtWl0vLnRlc3QobGluZS50cmltKCkpKS5sZW5ndGg7XG4gICAgaWYgKGNhcGl0YWxpemVkTGluZXMgLyBsaW5lcy5sZW5ndGggPiAwLjcpIHBvZXRyeVNjb3JlICs9IDE7XG4gICAgXG4gICAgLy8gNS4g0KDQuNGC0LzQuNGH0L3QvtGB0YLRjCAo0L/QvtCy0YLQvtGA0Y/RjtGJ0LDRj9GB0Y8g0LTQu9C40L3QsCDRgdGC0YDQvtC6KVxuICAgIGNvbnN0IGxpbmVMZW5ndGhzID0gbGluZXMubWFwKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoKTtcbiAgICBjb25zdCBsZW5ndGhWYXJpYW5jZSA9IHRoaXMuY2FsY3VsYXRlVmFyaWFuY2UobGluZUxlbmd0aHMpO1xuICAgIGlmIChsZW5ndGhWYXJpYW5jZSA8IDEwMCkgcG9ldHJ5U2NvcmUgKz0gMTtcbiAgICBcbiAgICByZXR1cm4gcG9ldHJ5U2NvcmUgPj0gNDtcbiAgfVxuXG4gIC8qKlxuICAgKiDQktGL0YfQuNGB0LvRj9C10YIg0LTQuNGB0L/QtdGA0YHQuNGOINC80LDRgdGB0LjQstCwINGH0LjRgdC10LtcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGNhbGN1bGF0ZVZhcmlhbmNlKG51bWJlcnM6IG51bWJlcltdKTogbnVtYmVyIHtcbiAgICBjb25zdCBtZWFuID0gbnVtYmVycy5yZWR1Y2UoKHN1bSwgbnVtKSA9PiBzdW0gKyBudW0sIDApIC8gbnVtYmVycy5sZW5ndGg7XG4gICAgY29uc3Qgc3F1YXJlZERpZmZzID0gbnVtYmVycy5tYXAobnVtID0+IE1hdGgucG93KG51bSAtIG1lYW4sIDIpKTtcbiAgICByZXR1cm4gc3F1YXJlZERpZmZzLnJlZHVjZSgoc3VtLCBkaWZmKSA9PiBzdW0gKyBkaWZmLCAwKSAvIG51bWJlcnMubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqINCe0LHRgNCw0LHQsNGC0YvQstCw0LXRgiDRgtC10LrRgdGCINGBINGB0L7RhdGA0LDQvdC10L3QuNC10Lwg0YTQvtGA0LzQsNGC0LjRgNC+0LLQsNC90LjRj1xuICAgKi9cbiAgc3RhdGljIHByb2Nlc3NXaXRoRm9ybWF0dGluZyhwYXJhZ3JhcGhzOiBGb3JtYXR0ZWRQYXJhZ3JhcGhbXSk6IEZvcm1hdHRlZFBhcmFncmFwaFtdIHtcbiAgICBjb25zdCBmdWxsVGV4dCA9IHBhcmFncmFwaHMubWFwKHAgPT4gXG4gICAgICBwLmNvbnRlbnQubWFwKGMgPT4gYy50ZXh0KS5qb2luKCcnKVxuICAgICkuam9pbignXFxuJyk7XG4gICAgXG4gICAgY29uc3QgaXNQb2V0cnlUZXh0ID0gdGhpcy5pc1BvZXRyeShmdWxsVGV4dCk7XG4gICAgXG4gICAgcmV0dXJuIHBhcmFncmFwaHMubWFwKHBhcmFncmFwaCA9PiB7XG4gICAgICBjb25zdCBwcm9jZXNzZWRDb250ZW50ID0gcGFyYWdyYXBoLmNvbnRlbnQubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgLi4uaXRlbSxcbiAgICAgICAgdGV4dDogaXNQb2V0cnlUZXh0IFxuICAgICAgICAgID8gdGhpcy5wcm9jZXNzUG9ldHJ5VGV4dChpdGVtLnRleHQpXG4gICAgICAgICAgOiB0aGlzLnByb2Nlc3NSZWd1bGFyVGV4dChpdGVtLnRleHQpXG4gICAgICB9KSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnBhcmFncmFwaCxcbiAgICAgICAgY29udGVudDogcHJvY2Vzc2VkQ29udGVudCxcbiAgICAgICAgc3R5bGU6IGlzUG9ldHJ5VGV4dCAmJiBwYXJhZ3JhcGguc3R5bGUgPT09ICdub3JtYWwnID8gJ3BvZXRyeScgOiBwYXJhZ3JhcGguc3R5bGVcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog0J7QsdGA0LDQsdC+0YLQutCwINC+0LHRi9GH0L3QvtCz0L4g0YLQtdC60YHRgtCwXG4gICAqL1xuICBzdGF0aWMgcHJvY2Vzc1JlZ3VsYXJUZXh0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG5cbiAgICAvLyDQntGB0L3QvtCy0L3Ri9C1INC/0YDQsNCy0LjQu9CwINGC0LjQv9C+0LPRgNCw0YTQuNC60LhcbiAgICByZXN1bHQgPSB0aGlzLmFwcGx5QmFzaWNSdWxlcyhyZXN1bHQpO1xuICAgIHJlc3VsdCA9IHRoaXMuYXBwbHlOb25CcmVha2luZ1NwYWNlcyhyZXN1bHQpO1xuICAgIHJlc3VsdCA9IHRoaXMuYXBwbHlQdW5jdHVhdGlvbihyZXN1bHQpO1xuICAgIFxuICAgIC8vINCj0LTQsNC70Y/QtdC8INCy0YHQtSDQv9GD0YHRgtGL0LUg0YHRgtGA0L7QutC4INCyINC60L7QvdGG0LUg0YLQtdC60YHRgtCwXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyhcXHI/XFxuKSskL2csICcnKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICog0J7QsdGA0LDQsdC+0YLQutCwINGB0YLQuNGF0L7RgtCy0L7RgNC90L7Qs9C+INGC0LXQutGB0YLQsCDRgSDRgdC+0YXRgNCw0L3QtdC90LjQtdC8INGB0YLRgNGD0LrRgtGD0YDRi1xuICAgKi9cbiAgc3RhdGljIHByb2Nlc3NQb2V0cnlUZXh0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG4gICAgXG4gICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INGC0LDQsdGD0LvRj9GG0LjQuCDQuCDQvtGC0YHRgtGD0L/Ri1xuICAgIGNvbnN0IGxpbmVzID0gcmVzdWx0LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBwcm9jZXNzZWRMaW5lcyA9IGxpbmVzLm1hcChsaW5lID0+IHtcbiAgICAgIC8vINCh0L7RhdGA0LDQvdGP0LXQvCDQvdCw0YfQsNC70YzQvdGL0LUg0L/RgNC+0LHQtdC70Ysg0Lgg0YLQsNCx0YPQu9GP0YbQuNC4XG4gICAgICBjb25zdCBpbmRlbnQgPSBsaW5lLm1hdGNoKC9eW1xcc1xcdF0qLyk/LlswXSB8fCAnJztcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBsaW5lLnN1YnN0cmluZyhpbmRlbnQubGVuZ3RoKTtcbiAgICAgIFxuICAgICAgaWYgKGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbGluZTsgLy8g0J/Rg9GB0YLRi9C1INGB0YLRgNC+0LrQuCDQvdC1INC+0LHRgNCw0LHQsNGC0YvQstCw0LXQvFxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDQntCx0YDQsNCx0LDRgtGL0LLQsNC10Lwg0YLQvtC70YzQutC+INGB0L7QtNC10YDQttC40LzQvtC1LCDRgdC+0YXRgNCw0L3Rj9GPINC+0YLRgdGC0YPQv9GLXG4gICAgICBsZXQgcHJvY2Vzc2VkQ29udGVudCA9IGNvbnRlbnQ7XG4gICAgICBcbiAgICAgIC8vINCc0Y/Qs9C60LDRjyDQvtCx0YDQsNCx0L7RgtC60LAg0LTQu9GPINGB0YLQuNGF0L7QsiAo0LzQtdC90YzRiNC1INC40LfQvNC10L3QtdC90LjQuSlcbiAgICAgIHByb2Nlc3NlZENvbnRlbnQgPSB0aGlzLmFwcGx5UG9ldHJ5UnVsZXMocHJvY2Vzc2VkQ29udGVudCk7XG4gICAgICBcbiAgICAgIHJldHVybiBpbmRlbnQgKyBwcm9jZXNzZWRDb250ZW50O1xuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBwcm9jZXNzZWRMaW5lcy5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9GA0LjQvNC10L3Rj9C10YIg0LHQsNC30L7QstGL0LUg0L/RgNCw0LLQuNC70LAg0YLQuNC/0L7Qs9GA0LDRhNC40LrQuFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXBwbHlCYXNpY1J1bGVzKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG5cbiAgICAvLyAwLiDQl9Cw0YnQuNGC0LAg0L7RgiDRgdC70LjQv9Cw0L3QuNGPINGB0LvQvtCyOiDQstGA0LXQvNC10L3QvdC+INC30LDQvNC10L3Rj9C10LwgPiA8INC90LAgPlxcdTIwMEI8ICjQvdC10LLQuNC00LjQvNGL0Lkg0YDQsNC30LTQtdC70LjRgtC10LvRjClcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvPlxccys8L2csICc+XFx1MjAwQjwnKTtcblxuICAgIC8vIDEuINCc0L3QvtC20LXRgdGC0LLQtdC90L3Ri9C1INC/0YDQvtCx0LXQu9GLICjQt9Cw0LzQtdC90Y/QtdC8INC70Y7QsdGL0LUg0L/QvtGB0LvQtdC00L7QstCw0YLQtdC70YzQvdC+0YHRgtC4INC/0YDQvtCx0LXQu9GM0L3Ri9GFINGB0LjQvNCy0L7Qu9C+0LIsINC60YDQvtC80LUgXFxuLCDQvdCwINC+0LTQuNC9INC/0YDQvtCx0LXQuylcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvWyBcXHRcXHZcXGZcXHJdezIsfS9nLCAnICcpO1xuICAgIC8vIDFhLiDQo9Cx0LjRgNCw0LXQvCDQv9GA0L7QsdC10LvRiyDQsiDQvdCw0YfQsNC70LUg0Lgg0LrQvtC90YbQtSDQutCw0LbQtNC+0Lkg0YHRgtGA0L7QutC4ICjQvdC+INC90LUg0YLRgNC+0LPQsNC10Lwg0LLQvdGD0YLRgNC10L3QvdC40LUg0L/RgNC+0LHQtdC70Ysg0LzQtdC20LTRgyDRgdC70L7QstCw0LzQuClcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXlsgXFx0XSt8WyBcXHRdKyQvZ20sICcnKTtcblxuICAgIC8vIDFiLiDQnNC10LbQtNGDINC30L3QsNC60L7QvCDihJYg0Lgg0YbQuNGE0YDQvtC5INCy0YHQtdCz0LTQsCDQvdC10YDQsNC30YDRi9Cy0L3Ri9C5INC/0YDQvtCx0LXQu1xuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC/ihJZcXHMqKFxcZCspL2csICfihJZcXHUwMEEwJDEnKTtcblxuICAgIC8vIDIuINCX0LDRidC40YLQsCDQtNC10YTQuNGB0LAg0LzQtdC20LTRgyDQsdGD0LrQstCw0LzQuCAo0LHRg9C60LLQsC3QtNC10YTQuNGBLdCx0YPQutCy0LAsINGB0LvQvtC20L3Ri9C1INGB0LvQvtCy0LAsINGE0LDQvNC40LvQuNC4LCDRgtC+0L/QvtC90LjQvNGLINC4INGCLtC0LilcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvKFxccHtMfSktKFxccHtMfSkvZ3UsICckMVtbSFlQSEVOXV0kMicpO1xuXG4gICAgLy8gMy4g0JfQsNGJ0LjRgtCwINC00LXRhNC40YHQsCDQsiDRgdC70L7QttC90YvRhSDRgdC70L7QstCw0YUg0Lgg0L3QsNGA0LXRh9C40Y/RhVxuICAgIGNvbnN0IGh5cGhlbldvcmRzID0gW1xuICAgICAgJ9C40Lct0LfQsCcsICfQuNC3LdC/0L7QtCcsICfQv9C+LdGA0YPRgdGB0LrQuCcsICfQv9C+LdC80L7QtdC80YMnLCAn0L/Qvi3RgtCy0L7QtdC80YMnLCAn0L/Qvi3QvdCw0YjQtdC80YMnLCAn0L/Qvi3QstCw0YjQtdC80YMnLFxuICAgICAgJ9C60L7QtS3Rh9GC0L4nLCAn0LrQvtC1LdC60LDQuicsICfQutGC0L4t0L3QuNCx0YPQtNGMJywgJ9GH0YLQvi3QvdC40LHRg9C00YwnLCAn0LPQtNC1LdC90LjQsdGD0LTRjCcsICfQutC+0LPQtNCwLdC70LjQsdC+JyxcbiAgICAgICfQutCw0Lot0YLQvicsICfQstGB0LUt0YLQsNC60LgnLCAn0L/Qvi3RgdCy0L7QtdC80YMnLCAn0L/Qvi3RgdGC0LDRgNC+0LzRgycsICfQv9C+LdC90L7QstC+0LzRgycsICfQv9C+LdCw0L3Qs9C70LjQudGB0LrQuCcsXG4gICAgICAn0L/Qvi3RhNGA0LDQvdGG0YPQt9GB0LrQuCcsICfQv9C+LdC90LXQvNC10YbQutC4JywgJ9C/0L4t0LjRgtCw0LvRjNGP0L3RgdC60LgnLCAn0L/Qvi3QuNGB0L/QsNC90YHQutC4JywgJ9C/0L4t0LrQuNGC0LDQudGB0LrQuCcsXG4gICAgICAn0L/Qvi3Rj9C/0L7QvdGB0LrQuCcsICfQv9C+LdGD0LrRgNCw0LjQvdGB0LrQuCcsICfQv9C+LdCx0LXQu9C+0YDRg9GB0YHQutC4JywgJ9C/0L4t0L/QvtC70YzRgdC60LgnLCAn0L/Qvi3Rh9C10YjRgdC60LgnLFxuICAgICAgJ9C/0L4t0LPRgNC10YfQtdGB0LrQuCcsICfQv9C+LdGC0YPRgNC10YbQutC4JywgJ9C/0L4t0LDRgNCw0LHRgdC60LgnLCAn0L/Qvi3QtdCy0YDQtdC50YHQutC4JywgJ9C/0L4t0LvQsNGC0LjQvdGB0LrQuCcsXG4gICAgICAn0L/Qvi3RgdC+0LLRgNC10LzQtdC90L3QvtC80YMnLCAn0L/Qvi3RgdGC0LDRgNC40L3QvdC+0LzRgycsICfQv9C+LdC00LXRgtGB0LrQuCcsICfQv9C+LdCy0LfRgNC+0YHQu9C+0LzRgycsICfQv9C+LdGC0L7QstCw0YDQuNGJ0LXRgdC60LgnLFxuICAgICAgJ9C/0L4t0L/RgNC40Y/RgtC10LvRjNGB0LrQuCcsICfQv9C+LdGA0L7QtNGB0YLQstC10L3QvdC+0LzRgycsICfQv9C+LdC+0YLQtdGH0LXRgdC60LgnLCAn0L/Qvi3QvNCw0YLQtdGA0LjQvdGB0LrQuCcsICfQv9C+LdCx0YDQsNGC0YHQutC4JyxcbiAgICAgICfQv9C+LdGB0LXRgdGC0YDQuNC90YHQutC4JywgJ9C/0L4t0LTQtdC70L7QstC+0LzRgycsICfQv9C+LdC00YDRg9C20LXRgdC60LgnLCAn0L/Qvi3QvtGB0L7QsdC10L3QvdC+0LzRgycsICfQv9C+LdC+0YHQvtCx0L7QvNGDJ1xuICAgIF07XG4gICAgaHlwaGVuV29yZHMuZm9yRWFjaCh3b3JkID0+IHtcbiAgICAgIC8vINCX0LDRidC40YnQsNC10Lwg0L7QsdCwINCy0LDRgNC40LDQvdGC0LA6INGBIFwi0LVcIiDQuCDRgSBcItGRXCIgKNC90LDQv9GA0LjQvNC10YAsINCy0YHRkS3RgtCw0LrQuC/QstGB0LUt0YLQsNC60LgpXG4gICAgICBjb25zdCBzYWZlID0gd29yZC5yZXBsYWNlKC8tL2csICdbW0hZUEhFTl1dJyk7XG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAod29yZC5yZXBsYWNlKCfQtScsICdb0LXRkV0nKSwgJ2dpJyk7XG4gICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShyZWdleCwgc2FmZSk7XG4gICAgfSk7XG5cbiAgICAvLyA0LiDQl9Cw0YnQuNGC0LAg0YHQvtC60YDQsNGJ0LXQvdC40LlcbiAgICByZXN1bHQgPSByZXN1bHRcbiAgICAgIC5yZXBsYWNlKC9cXGLRglxcLi3QtVxcLi9naSwgJ1tbVF9FXV0nKVxuICAgICAgLnJlcGxhY2UoL1xcYtGCXFwuLdC0XFwuL2dpLCAnW1tUX0RdXScpXG4gICAgICAucmVwbGFjZSgvXFxi0YJcXC4t0L9cXC4vZ2ksICdbW1RfUF1dJylcbiAgICAgIC5yZXBsYWNlKC9cXGLRglxcLi3QulxcLi9naSwgJ1tbVF9LXV0nKVxuICAgICAgLnJlcGxhY2UoL1xcYtGCXFwuLdC9XFwuL2dpLCAnW1tUX05dXScpXG4gICAgICAucmVwbGFjZSgvXFxi0YJcXC4t0L5cXC4vZ2ksICdbW1RfT11dJylcbiAgICAgIC5yZXBsYWNlKC9cXGLQuFxcINGCXFwuLdC0XFwuL2dpLCAnW1tJX1RfRF1dJyk7XG5cbiAgICAvLyA1LiDQlNC40LDQv9Cw0LfQvtC9INGH0LjRgdC10Ls6IDE5NjYtMTk3NyDihpIgMTk2NuKAkzE5NzcgKGVuIGRhc2gpLCDQsdC10Lcg0L/RgNC+0LHQtdC70L7QsiDQstC+0LrRgNGD0LNcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvKFxcZHsxLDR9KVxccyotXFxzKihcXGR7MSw0fSkvZywgJyQx4oCTJDInKTtcbiAgICAvLyA1YS4g0KPQtNCw0LvRj9C10Lwg0L/RgNC+0LHQtdC70Ysg0LLQvtC60YDRg9CzIGVuIGRhc2gg0LzQtdC20LTRgyDRh9C40YHQu9Cw0LzQuCAoMjAyMCAtIDIwMjEg4oaSIDIwMjDigJMyMDIxKVxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC8oXFxkezEsNH0pXFxzKuKAk1xccyooXFxkezEsNH0pL2csICckMeKAkyQyJyk7XG5cbiAgICAvLyA2LiBlbiBkYXNoINC80LXQttC00YMg0YHQu9C+0LLQsNC80Lgg0LjQu9C4INGBINC/0YDQvtCx0LXQu9Cw0LzQuCDihpIgZW0gZGFzaCDRgSDQvdC10YDQsNC30YDRi9Cy0L3Ri9C8INC/0YDQvtCx0LXQu9C+0LxcbiAgICAvLyAoXFxzfF4p4oCTKFxccykg4oaSIFxcdTAwQTDigJQgXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyhcXHN8XnxcXG4p4oCTKFxccykvZywgJyQxXFx1MDBBMOKAlCAnKTtcbiAgICAvLyDQotCw0LrQttC1OiDQv9GA0L7QsdC10LsgZW4gZGFzaCDQv9GA0L7QsdC10LtcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXFxzK+KAk1xccysvZywgJ1xcdTAwQTDigJQgJyk7XG5cbiAgICAvLyA3LiDQn9GA0L7QsdC10Lst0LTQu9C40L3QvdC+0LUg0YLQuNGA0LUt0L/RgNC+0LHQtdC7INC4INC/0YDQvtCx0LXQuy3QtNC10YTQuNGBLdC/0YDQvtCx0LXQuyDihpIg0L3QtdGA0LDQt9GA0YvQstC90YvQuSDQv9GA0L7QsdC10LvigJTQvtCx0YvRh9C90YvQuSDQv9GA0L7QsdC10LtcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXFxzKygtfOKAlClcXHMrL2csICdcXHUwMEEw4oCUICcpO1xuXG4gICAgLy8gOC4g0JzQtdC20LTRgyDRgdC70L7QstCw0LzQuCAo0LHRg9C60LLQsC3Qv9GA0L7QsdC10Lst0LTQtdGE0LjRgS3Qv9GA0L7QsdC10Lst0LHRg9C60LLQsClcbiAgICAvLyDQn9C+0YHQu9C1INGC0LjRgNC1INCy0YHQtdCz0LTQsCDQv9GA0L7QsdC10LtcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvKFxccHtMfSlcXHMqLVxccyooXFxwe0x9KS9ndSwgJyQxIOKAlCAkMicpO1xuICAgIC8vINCf0L7RgdC70LUgZW0gZGFzaC9lbiBkYXNoINC80LXQttC00YMg0YHQu9C+0LLQsNC80Lgg4oCUINCy0YHQtdCz0LTQsCDQv9GA0L7QsdC10LssINCa0KDQntCc0JUg0LTQuNCw0L/QsNC30L7QvdC+0LIg0YfQuNGB0LXQu1xuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC/igJQoPyFcXGQpKFxcUykvZywgJ+KAlCAkMScpO1xuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC/igJMoPyFcXGQpKFxcUykvZywgJ+KAkyAkMScpO1xuXG4gICAgLy8gOS4g0JIg0L3QsNGH0LDQu9C1INGB0YLRgNC+0LrQuCAo0LTQuNCw0LvQvtCz0LgpXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyhefFxcbiktXFxzL2d1LCAnJDHigJQgJyk7XG5cbiAgICAvLyAxMC4g0JLQvtC30LLRgNCw0YnQsNC10Lwg0YHQvtC60YDQsNGJ0LXQvdC40Y8sINC00LXRhNC40YHRiyDQstC90YPRgtGA0Lgg0YHQu9C+0LIg0Lgg0YHQu9C+0LbQvdGL0YUg0YHQu9C+0LJcbiAgICByZXN1bHQgPSByZXN1bHRcbiAgICAgIC5yZXBsYWNlKC9cXFtcXFtUX0VcXF1cXF0vZywgJ9GCLi3QtS4nKVxuICAgICAgLnJlcGxhY2UoL1xcW1xcW1RfRFxcXVxcXS9nLCAn0YIuLdC0LicpXG4gICAgICAucmVwbGFjZSgvXFxbXFxbVF9QXFxdXFxdL2csICfRgi4t0L8uJylcbiAgICAgIC5yZXBsYWNlKC9cXFtcXFtUX0tcXF1cXF0vZywgJ9GCLi3Qui4nKVxuICAgICAgLnJlcGxhY2UoL1xcW1xcW1RfTlxcXVxcXS9nLCAn0YIuLdC9LicpXG4gICAgICAucmVwbGFjZSgvXFxbXFxbVF9PXFxdXFxdL2csICfRgi4t0L4uJylcbiAgICAgIC5yZXBsYWNlKC9cXFtcXFtJX1RfRFxcXVxcXS9nLCAn0Lgg0YIu0LQuJylcbiAgICAgIC5yZXBsYWNlKC9cXFtcXFtIWVBIRU5cXF1cXF0vZywgJy0nKTtcblxuICAgIC8vIDExLiDQl9Cw0LzQtdC90LAg0YLRgNC10YUg0YLQvtGH0LXQuiDQvdCwINC80L3QvtCz0L7RgtC+0YfQuNC1XG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoL1xcLnszLH0vZywgdGhpcy5FTExJUFNJUyk7XG4gICAgXG4gICAgLy8gMTIuINCf0YDQvtCx0LXQu9GLINC/0LXRgNC10LQg0LfQvdCw0LrQsNC80Lgg0L/RgNC10L/QuNC90LDQvdC40Y9cbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXFxzKyhbLC47OiE/XSkvZywgJyQxJyk7XG4gICAgXG4gICAgLy8gMTMuINCf0YDQvtCx0LXQu9GLINC/0L7RgdC70LUg0LfQvdCw0LrQvtCyINC/0YDQtdC/0LjQvdCw0L3QuNGPXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyhbLC47OiE/XSkoW9CQLdCv0LAt0Y/RkdCBQS1aYS16XSkvZywgJyQxICQyJyk7XG4gICAgXG4gICAgLy8gMTQuINCf0YDQvtCx0LXQu9GLINCyINGB0LrQvtCx0LrQsNGFXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoL1xcKFxccysvZywgJygnKTtcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXFxzK1xcKS9nLCAnKScpO1xuXG4gICAgLy8g0JIg0YHQsNC80L7QvCDQutC+0L3RhtC1OiDQvdC+0YDQvNCw0LvQuNC30YPQtdC8INC00LLQvtC50L3Ri9C1INC/0YDQvtCx0LXQu9GLINC00L4g0L7QtNC90L7Qs9C+XG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyB7Mix9L2csICcgJyk7XG5cbiAgICAvLyA5OS4g0JLQvtGB0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INC90LXQstC40LTQuNC80YvQuSDRgNCw0LfQtNC10LvQuNGC0LXQu9GMINC80LXQttC00YMg0YLQtdCz0LDQvNC4XG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoL1xcdTIwMEIvZywgJyAnKTtcblxuICAgIC8vINCf0L7RgdC70LUg0L7QtNC90L7QsdGD0LrQstC10L3QvdGL0YUg0L/RgNC10LTQu9C+0LPQvtCyIOKAlCDQvdC10YDQsNC30YDRi9Cy0L3Ri9C5INC/0YDQvtCx0LXQuyAo0YPQu9GD0YfRiNC10L3QvdCw0Y8g0YDQtdCz0YPQu9GP0YDQutCwKVxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC8oXnxbXFxzLiw7OiE/XCInwqvCuygpXFxbXFxde30tXSkoW9Cy0LrRgdGD0L7Rj9C4XSlcXHMrKFvQkC3Qr9CwLdGPQS1aYS16XSkvZ211LCAnJDEkMlxcdTAwQTAkMycpO1xuXG4gICAgLy8g0JzQtdC20LTRgyDRh9C40YHQu9C+0Lwg0Lgg0YHQu9C+0LLQvtC8IOKAlCDQvdC10YDQsNC30YDRi9Cy0L3Ri9C5INC/0YDQvtCx0LXQu1xuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC8oXFxkKVxccysoW9CQLdCv0LAt0Y9BLVphLXpdKS9nLCAnJDFcXHUwMEEwJDInKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICog0J/RgNC40LzQtdC90Y/QtdGCINC/0YDQsNCy0LjQu9CwINC00LvRjyDRgdGC0LjRhdC+0YLQstC+0YDQtdC90LjQuSAo0LHQvtC70LXQtSDQtNC10LvQuNC60LDRgtC90L4pXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhcHBseVBvZXRyeVJ1bGVzKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG5cbiAgICAvLyDQotC+0LvRjNC60L4g0L7RgdC90L7QstC90YvQtSDQv9GA0LDQstC40LvQsCwg0L3QtSDRgtGA0L7Qs9Cw0LXQvCDRgdGC0YDRg9C60YLRg9GA0YNcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvLS0vZywgdGhpcy5FTV9EQVNIKTtcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXFwuezMsfS9nLCB0aGlzLkVMTElQU0lTKTtcbiAgICBcbiAgICAvLyDQntGB0YLQvtGA0L7QttC90L4g0YEg0L/RgNC+0LHQtdC70LDQvNC4INCyINGB0YLQuNGF0LDRhVxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC9cXHMrKFssLjs6IT9dKS9nLCAnJDEnKTtcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvKFssLjs6IT9dKShb0JAt0K/QsC3Rj9GR0IFdKS9nLCAnJDEgJDInKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICog0J/RgNC40LzQtdC90Y/QtdGCINC90LXRgNCw0LfRgNGL0LLQvdGL0LUg0L/RgNC+0LHQtdC70YtcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFwcGx5Tm9uQnJlYWtpbmdTcGFjZXModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBsZXQgcmVzdWx0ID0gdGV4dDtcblxuICAgIC8vINCa0L7RgNC+0YLQutC40LUg0YHQu9C+0LLQsFxuICAgIGNvbnN0IHNob3J0V29yZHMgPSBbJ9CwJywgJ9CyJywgJ9C4JywgJ9C6JywgJ9C+JywgJ9GBJywgJ9GDJywgJ9C90LUnLCAn0L3QsCcsICfQvtGCJywgJ9C00L4nLCAn0LfQsCcsICfQuNC3JywgJ9C/0L4nLCAn0YHQvicsICfQstC+JywgJ9C+0LEnXTtcbiAgICBzaG9ydFdvcmRzLmZvckVhY2god29yZCA9PiB7XG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHt3b3JkfVxcXFxzK2AsICdnaScpO1xuICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UocmVnZXgsIHdvcmQgKyB0aGlzLk5PTl9CUkVBS0lOR19TUEFDRSk7XG4gICAgfSk7XG4gICAgXG4gICAgLy8g0KfQuNGB0LvQsCDRgSDQtdC00LjQvdC40YbQsNC80Lgg0LjQt9C80LXRgNC10L3QuNGPXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyhcXGQrKVxccyso0LrQs3zQs3zRgnzQvNCzfNC80Lx80LTQvHzRgdC8fNC8fNC60Lx80Lt80LzQu3zRgNGD0LF80LrQvtC/fNC00L7Qu9C7fNC10LLRgNC+KS9naSwgXG4gICAgICBgJDEke3RoaXMuTk9OX0JSRUFLSU5HX1NQQUNFfSQyYCk7XG4gICAgXG4gICAgLy8g0JjQvdC40YbQuNCw0LvRiyDRgSDRhNCw0LzQuNC70LjQtdC5XG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLyhb0JAt0K/QgV1cXC4pXFxzKyhb0JAt0K/QgV1cXC4pXFxzKyhb0JAt0K/QgV1b0LAt0Y/RkV0rKS9nLCBcbiAgICAgIGAkMSR7dGhpcy5OT05fQlJFQUtJTkdfU1BBQ0V9JDIke3RoaXMuTk9OX0JSRUFLSU5HX1NQQUNFfSQzYCk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqINCf0YDQuNC80LXQvdGP0LXRgiDQv9GA0LDQstC40LvQsCDQv9GD0L3QutGC0YPQsNGG0LjQuFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXBwbHlQdW5jdHVhdGlvbih0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGxldCByZXN1bHQgPSB0ZXh0O1xuXG4gICAgLy8g0JTQuNCw0LvQvtCz0LhcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvXlxccyotXFxzKi9nbSwgdGhpcy5FTV9EQVNIICsgdGhpcy5FTl9TUEFDRSk7XG4gICAgXG4gICAgLy8g0J/RgNC+0YbQtdC90YLRi1xuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC8oXFxkKylcXHMqJS9nLCBgJDEke3RoaXMuVEhJTl9TUEFDRX0lYCk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqINCe0L/RgNC10LTQtdC70Y/QtdGCINGB0YLRgNGD0LrRgtGD0YDRgyDRh9C10YLQstC10YDQvtGB0YLQuNGI0LjQuVxuICAgKi9cbiAgc3RhdGljIGRldGVjdFN0YW56YVN0cnVjdHVyZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBzdGFuemFzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBjdXJyZW50U3RhbnphOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBlbXB0eUxpbmVDb3VudCA9IDA7XG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIGlmIChsaW5lLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZW1wdHlMaW5lQ291bnQrKztcbiAgICAgICAgaWYgKGVtcHR5TGluZUNvdW50ID49IDEgJiYgY3VycmVudFN0YW56YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8g0JrQvtC90LXRhiDRgdGC0YDQvtGE0YtcbiAgICAgICAgICBzdGFuemFzLnB1c2goY3VycmVudFN0YW56YS5qb2luKCdcXG4nKSk7XG4gICAgICAgICAgY3VycmVudFN0YW56YSA9IFtdO1xuICAgICAgICAgIGVtcHR5TGluZUNvdW50ID0gMDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFN0YW56YS5wdXNoKGxpbmUpO1xuICAgICAgICBlbXB0eUxpbmVDb3VudCA9IDA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INC/0L7RgdC70LXQtNC90Y7RjiDRgdGC0YDQvtGE0YNcbiAgICBpZiAoY3VycmVudFN0YW56YS5sZW5ndGggPiAwKSB7XG4gICAgICBzdGFuemFzLnB1c2goY3VycmVudFN0YW56YS5qb2luKCdcXG4nKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YW56YXM7XG4gIH1cblxuICAvKipcbiAgICog0J7QsdGA0LDQsdCw0YLRi9Cy0LDQtdGCINC/0YDQvtGB0YLQvtC5INGC0LXQutGB0YIgKNC00LvRjyDQvtCx0YDQsNGC0L3QvtC5INGB0L7QstC80LXRgdGC0LjQvNC+0YHRgtC4KVxuICAgKi9cbiAgc3RhdGljIHByb2Nlc3ModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBpc1BvZXRyeVRleHQgPSB0aGlzLmlzUG9ldHJ5KHRleHQpO1xuICAgIFxuICAgIGlmIChpc1BvZXRyeVRleHQpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NQb2V0cnlUZXh0KHRleHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm9jZXNzUmVndWxhclRleHQodGV4dCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCh0L7Qt9C00LDQtdGCINGB0YLQsNGC0LjRgdGC0LjQutGDINC+0LHRgNCw0LHQvtGC0LrQuFxuICAgKi9cbiAgc3RhdGljIGdldFByb2Nlc3NpbmdTdGF0cyhvcmlnaW5hbFRleHQ6IHN0cmluZywgcHJvY2Vzc2VkVGV4dDogc3RyaW5nKToge1xuICAgIG9yaWdpbmFsTGVuZ3RoOiBudW1iZXI7XG4gICAgcHJvY2Vzc2VkTGVuZ3RoOiBudW1iZXI7XG4gICAgaXNQb2V0cnk6IGJvb2xlYW47XG4gICAgc3BhY2VzUmVwbGFjZWQ6IG51bWJlcjtcbiAgICBkYXNoZXNSZXBsYWNlZDogbnVtYmVyO1xuICAgIGVsbGlwc2lzUmVwbGFjZWQ6IG51bWJlcjtcbiAgICBzdGFuemFDb3VudD86IG51bWJlcjtcbiAgfSB7XG4gICAgY29uc3QgaXNQb2V0cnlUZXh0ID0gdGhpcy5pc1BvZXRyeShvcmlnaW5hbFRleHQpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBvcmlnaW5hbExlbmd0aDogb3JpZ2luYWxUZXh0Lmxlbmd0aCxcbiAgICAgIHByb2Nlc3NlZExlbmd0aDogcHJvY2Vzc2VkVGV4dC5sZW5ndGgsXG4gICAgICBpc1BvZXRyeTogaXNQb2V0cnlUZXh0LFxuICAgICAgc3BhY2VzUmVwbGFjZWQ6IChvcmlnaW5hbFRleHQubWF0Y2goL1sgXXsyLH0vZykgfHwgW10pLmxlbmd0aCxcbiAgICAgIGRhc2hlc1JlcGxhY2VkOiAob3JpZ2luYWxUZXh0Lm1hdGNoKC8tLS9nKSB8fCBbXSkubGVuZ3RoLFxuICAgICAgZWxsaXBzaXNSZXBsYWNlZDogKG9yaWdpbmFsVGV4dC5tYXRjaCgvXFwuezMsfS9nKSB8fCBbXSkubGVuZ3RoLFxuICAgICAgc3RhbnphQ291bnQ6IGlzUG9ldHJ5VGV4dCA/IHRoaXMuZGV0ZWN0U3RhbnphU3RydWN0dXJlKG9yaWdpbmFsVGV4dCkubGVuZ3RoIDogdW5kZWZpbmVkLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C40YLRjCDQv9GA0LjQvNC10YAg0YLQtdC60YHRgtCwICjQvtCx0L3QvtCy0LvQtdC90L3Ri9C5KVxuICAgKi9cbiAgc3RhdGljIGdldEV4YW1wbGVUZXh0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGDQn9GA0LjQvNC10YAg0YLQtdC60YHRgtCwINGBICAg0YLQuNC/0L7Qs9GA0LDRhNGB0LrQuNC80Lgg0L7RiNC40LHQutCw0LzQuFxuXG7Qn9GA0L7QsdC70LXQvNGLICDRgSAgINC/0YDQvtCx0LXQu9Cw0LzQuCAgICDQuCDQt9C90LDQutCw0LzQuCAgICzRgtC+0YfQutCw0LzQuCAgIC5cbtCU0LXRhNC40YHRiyAgLS0gINCy0LzQtdGB0YLQviDRgtC40YDQtSDQuCDQvNC90L7Qs9C+0YLQvtGH0LjQtS4uLlxu0J/Qu9C+0YXQuNC1INC/0YDQvtCx0LXQu9GLINCyINGB0LrQvtCx0LrQsNGFKCDQstC+0YIg0YLQsNC6ICkuXG5cbtCd0LXRgNCw0LfRgNGL0LLQvdGL0LUg0L/RgNC+0LHQtdC70Ys6XG7QkiDQvNCw0LPQsNC30LjQvSDQt9CwINGF0LvQtdCx0L7QvC5cbtCaINCy0YDQsNGH0YMg0L3QsCDQvtGB0LzQvtGC0YAuXG7QndCwINGA0LDQsdC+0YLRgyDQsiDQvtGE0LjRgS5cbtCS0LXRgTogMTAg0LrQsywg0YDQvtGB0YI6IDE4MCDRgdC8Llxu0JAuINChLiDQn9GD0YjQutC40L0g0L3QsNC/0LjRgdCw0Lsg0LzQvdC+0LPQviDQv9GA0L7QuNC30LLQtdC00LXQvdC40LkuXG5cbtCU0LjQsNC70L7Qs9C4OlxuLSDQn9GA0LjQstC10YIhINCa0LDQuiDQtNC10LvQsD9cbi0g0KXQvtGA0L7RiNC+LCDRgdC/0LDRgdC40LHQviDQt9CwINCy0L7Qv9GA0L7RgS5cblxu0J/RgNC+0YbQtdC90YLRizog0YHQutC40LTQutCwIDE1JSDQvdCwINCy0YHQtSDRgtC+0LLQsNGA0YsuXG5cbtCf0KDQmNCc0JXQoCDQodCi0JjQpdCe0KLQktCe0KDQldCd0JjQrzpcblxuICAgICAgICDQkdC10LvQtdC10YIg0L/QsNGA0YPRgSDQvtC00LjQvdC+0LrQvtC5XG4gICAgICAgINCSINGC0YPQvNCw0L3QtSDQvNC+0YDRjyDQs9C+0LvRg9Cx0L7QvC4uLlxuICAgICAgICDQp9GC0L4g0LjRidC10YIg0L7QvSDQsiDRgdGC0YDQsNC90LUg0LTQsNC70LXQutC+0Lk/XG4gICAgICAgINCn0YLQviDQutC40L3Rg9C7INC+0L0g0LIg0LrRgNCw0Y4g0YDQvtC00L3QvtC8P1xuXG4gICAg0JjQs9GA0LDRjtGCINCy0L7Qu9C90YsgLS0g0LLQtdGC0LXRgCDRgdCy0LjRidC10YIsXG4gICAg0Jgg0LzQsNGH0YLQsCDQs9C90LXRgtGB0Y8g0Lgg0YHQutGA0YvQv9C40YIuLi5cbiAgICAgICAg0KPQstGLISDQvtC9INGB0YfQsNGB0YLQuNGPINC90LUg0LjRidC10YJcbiAgICAgICAg0Jgg0L3QtSDQvtGCINGB0YfQsNGB0YLQuNGPINCx0LXQttC40YIhXG5cbtCf0L7QtCDQvdC40Lwg0YHRgtGA0YPRjyDRgdCy0LXRgtC70LXQuSDQu9Cw0LfRg9GA0LgsXG7QndCw0LQg0L3QuNC8INC70YPRhyDRgdC+0LvQvdGG0LAg0LfQvtC70L7RgtC+0LkuLi5cbiAgICDQkCDQvtC9LCDQvNGP0YLQtdC20L3Ri9C5LCDQv9GA0L7RgdC40YIg0LHRg9GA0LgsXG4gICAg0JrQsNC6INCx0YPQtNGC0L4g0LIg0LHRg9GA0Y/RhSDQtdGB0YLRjCDQv9C+0LrQvtC5IVxuXG7QrdGC0L7RgiDRgtC10LrRgdGCINGB0L7QtNC10YDQttC40YIg0YDQsNC30LvQuNGH0L3Ri9C1INGC0LjQv9C+0LPRgNCw0YTRgdC60LjQtSDQvtGI0LjQsdC60Lgg0Lgg0LTQtdC80L7QvdGB0YLRgNC40YDRg9C10YIg0YDQsNCx0L7RgtGDINGBINC/0L7RjdC30LjQtdC5LmA7XG4gIH1cbn1cblxuLy8g0K3QutGB0L/QvtGA0YIg0LTQu9GPINC+0LHRgNCw0YLQvdC+0Lkg0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0LhcbmV4cG9ydCBjb25zdCBUeXBvZ3JhcGh5UHJvY2Vzc29yID0gQWR2YW5jZWRUeXBvZ3JhcGh5UHJvY2Vzc29yO1xuXG5leHBvcnQgZnVuY3Rpb24gdHlwb2dyYXBoVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gQWR2YW5jZWRUeXBvZ3JhcGh5UHJvY2Vzc29yLnByb2Nlc3ModGV4dCk7XG59XG5cbmZ1bmN0aW9uIHR5cG9ncmFwaEh0bWwoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgJCA9IGNoZWVyaW8ubG9hZChodG1sKTtcbiAgJCgnYm9keSwgYm9keSAqJykuY29udGVudHMoKS5lYWNoKGZ1bmN0aW9uICh0aGlzOiBhbnkpIHtcbiAgICAvLyDQldGB0LvQuCDRjdGC0L4g0YLQtdC60YHRgiDQstC90YPRgtGA0Lgg0L/Rg9GB0YLQvtCz0L4gPHA+IOKAlCDQvdC1INGC0YDQvtCz0LDQtdC8XG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ3RleHQnKSB7XG4gICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLnBhcmVudCBhcyBhbnk7XG4gICAgICBpZiAoXG4gICAgICAgIHBhcmVudCAmJlxuICAgICAgICBwYXJlbnQudGFnTmFtZSA9PT0gJ3AnICYmXG4gICAgICAgICghdGhpcy5kYXRhIHx8IHRoaXMuZGF0YS5yZXBsYWNlKC9cXHN8XFx1MDBBMHwmbmJzcDsvZywgJycpID09PSAnJylcbiAgICAgICkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmRhdGEgPSB0eXBvZ3JhcGhUZXh0KHRoaXMuZGF0YSB8fCAnJyk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuICQuaHRtbCgpO1xufSJdLCJuYW1lcyI6WyJjaGVlcmlvIiwiQWR2YW5jZWRUeXBvZ3JhcGh5UHJvY2Vzc29yIiwiTk9OX0JSRUFLSU5HX1NQQUNFIiwiVEhJTl9TUEFDRSIsIkVNX0RBU0giLCJFTExJUFNJUyIsIkVOX1NQQUNFIiwiaXNQb2V0cnkiLCJ0ZXh0IiwibGluZXMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJ0cmltIiwibGVuZ3RoIiwicG9ldHJ5U2NvcmUiLCJhdmdMaW5lTGVuZ3RoIiwicmVkdWNlIiwic3VtIiwibGluZUJyZWFrcyIsIm1hdGNoIiwid29yZENvdW50IiwiaW5kZW50ZWRMaW5lcyIsInN0YXJ0c1dpdGgiLCJjYXBpdGFsaXplZExpbmVzIiwidGVzdCIsImxpbmVMZW5ndGhzIiwibWFwIiwibGVuZ3RoVmFyaWFuY2UiLCJjYWxjdWxhdGVWYXJpYW5jZSIsIm51bWJlcnMiLCJtZWFuIiwibnVtIiwic3F1YXJlZERpZmZzIiwiTWF0aCIsInBvdyIsImRpZmYiLCJwcm9jZXNzV2l0aEZvcm1hdHRpbmciLCJwYXJhZ3JhcGhzIiwiZnVsbFRleHQiLCJwIiwiY29udGVudCIsImMiLCJqb2luIiwiaXNQb2V0cnlUZXh0IiwicGFyYWdyYXBoIiwicHJvY2Vzc2VkQ29udGVudCIsIml0ZW0iLCJwcm9jZXNzUG9ldHJ5VGV4dCIsInByb2Nlc3NSZWd1bGFyVGV4dCIsInN0eWxlIiwicmVzdWx0IiwiYXBwbHlCYXNpY1J1bGVzIiwiYXBwbHlOb25CcmVha2luZ1NwYWNlcyIsImFwcGx5UHVuY3R1YXRpb24iLCJyZXBsYWNlIiwicHJvY2Vzc2VkTGluZXMiLCJpbmRlbnQiLCJzdWJzdHJpbmciLCJhcHBseVBvZXRyeVJ1bGVzIiwiaHlwaGVuV29yZHMiLCJmb3JFYWNoIiwid29yZCIsInNhZmUiLCJyZWdleCIsIlJlZ0V4cCIsInNob3J0V29yZHMiLCJkZXRlY3RTdGFuemFTdHJ1Y3R1cmUiLCJzdGFuemFzIiwiY3VycmVudFN0YW56YSIsImVtcHR5TGluZUNvdW50IiwicHVzaCIsInByb2Nlc3MiLCJnZXRQcm9jZXNzaW5nU3RhdHMiLCJvcmlnaW5hbFRleHQiLCJwcm9jZXNzZWRUZXh0Iiwib3JpZ2luYWxMZW5ndGgiLCJwcm9jZXNzZWRMZW5ndGgiLCJzcGFjZXNSZXBsYWNlZCIsImRhc2hlc1JlcGxhY2VkIiwiZWxsaXBzaXNSZXBsYWNlZCIsInN0YW56YUNvdW50IiwidW5kZWZpbmVkIiwiZ2V0RXhhbXBsZVRleHQiLCJUeXBvZ3JhcGh5UHJvY2Vzc29yIiwidHlwb2dyYXBoVGV4dCIsInR5cG9ncmFwaEh0bWwiLCJodG1sIiwiJCIsImxvYWQiLCJjb250ZW50cyIsImVhY2giLCJ0eXBlIiwicGFyZW50IiwidGFnTmFtZSIsImRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/typography.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/parse5","vendor-chunks/iconv-lite","vendor-chunks/htmlparser2","vendor-chunks/entities","vendor-chunks/cheerio","vendor-chunks/css-select","vendor-chunks/encoding-sniffer","vendor-chunks/domutils","vendor-chunks/css-what","vendor-chunks/domhandler","vendor-chunks/cheerio-select","vendor-chunks/whatwg-mimetype","vendor-chunks/whatwg-encoding","vendor-chunks/dom-serializer","vendor-chunks/nth-check","vendor-chunks/parse5-htmlparser2-tree-adapter","vendor-chunks/parse5-parser-stream","vendor-chunks/safer-buffer","vendor-chunks/domelementtype","vendor-chunks/boolbase","vendor-chunks/underscore","vendor-chunks/mammoth","vendor-chunks/bluebird","vendor-chunks/jszip","vendor-chunks/pizzip","vendor-chunks/xmlbuilder","vendor-chunks/pako","vendor-chunks/lop","vendor-chunks/readable-stream","vendor-chunks/inherits","vendor-chunks/dingbat-to-unicode","vendor-chunks/docx","vendor-chunks/util-deprecate","vendor-chunks/string_decoder","vendor-chunks/safe-buffer","vendor-chunks/process-nextick-args","vendor-chunks/path-is-absolute","vendor-chunks/option","vendor-chunks/lie","vendor-chunks/isarray","vendor-chunks/immediate","vendor-chunks/core-util-is","vendor-chunks/base64-js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FStore1%2FYandex.Disk.localized%2Fwww-yandex%2Ftypography-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();