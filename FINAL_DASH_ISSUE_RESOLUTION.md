# –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è —Ç–∏—Ä–µ

## üéØ –ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ **—Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞** —Å –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ–º —Ç–∏—Ä–µ –≤ –Ω–∞—á–∞–ª–µ –∞–±–∑–∞—Ü–µ–≤. –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –ù–ï –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–±–µ–ª–æ–≤, –∞ –≤ **–∞–ª–≥–æ—Ä–∏—Ç–º–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤** –ø–æ—Å–ª–µ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

## üîç –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã

–í —Ñ–∞–π–ª–µ `app/api/process/route.ts` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `processDocxXml` –µ—Å—Ç—å –ª–æ–≥–∏–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–∞—Ä—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–∏–º–≤–æ–ª–æ–≤ –º–µ–∂–¥—É –∏—Å—Ö–æ–¥–Ω—ã–º –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º. –ö–æ–≥–¥–∞ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç:
- En-dash (‚Äì) ‚Üí Em-dash (‚Äî)  
- Hyphen (-) ‚Üí Em-dash (‚Äî)

–°—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª** em-dash –∫–∞–∫ "–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª" –∏ –ø—Ä–æ–ø—É—Å–∫–∞–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∏—Å—Ö–æ–¥–Ω—ã–π —Å–∏–º–≤–æ–ª —Ç–∏—Ä–µ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–æ—Ç–µ—Ä–µ —Ç–∏—Ä–µ –ø—Ä–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ XML-—É–∑–ª–∞–º.

## ‚ùå –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥ (–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):

```typescript
if (charCode === 0xA0 || // NBSP
    charCode === 0x2009 || // Thin space
    charCode === 0x2011 || // Non-breaking hyphen
    charCode === 0x2013 || // En dash ‚Üê –ü–†–û–ë–õ–ï–ú–ê!
    charCode === 0x2014) { // Em dash ‚Üê –ü–†–û–ë–õ–ï–ú–ê!
  procIndex++; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–∞–∫ "–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π" —Å–∏–º–≤–æ–ª
} else {
  origIndex++; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Å–∏–º–≤–æ–ª
}
```

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ (–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):

```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ –∑–∞–º–µ–Ω—ã —Ç–∏—Ä–µ
const origChar = fullText[origIndex];
const procChar = processedText[procIndex];

// En-dash ‚Üí Em-dash –∑–∞–º–µ–Ω–∞
if ((origChar === '‚Äì' && procChar === '‚Äî') || 
    (origChar === '-' && procChar === '‚Äî')) {
  origIndex++;
  procIndex++; // –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª—ã
}
// –ï—Å–ª–∏ —Å–∏–º–≤–æ–ª—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç, –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã
else {
  const charCode = processedText.charCodeAt(procIndex);
  if (charCode === 0xA0 || // NBSP
      charCode === 0x2009 || // Thin space
      charCode === 0x2011) { // Non-breaking hyphen
    procIndex++;
  } else {
    origIndex++;
  }
}
```

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- `"‚Äì –ü—Ä–æ—Å—Ç–æ –±—ã—Ç—å —Å–æ –º–Ω–æ–π."` ‚Üí `" –ü—Ä–æ—Å—Ç–æ –±—ã—Ç—å —Å–æ –º–Ω–æ–π."` ‚ùå (—Ç–∏—Ä–µ –ø–æ—Ç–µ—Ä—è–Ω–æ)
- `"‚Äì –ê –¥–µ–Ω–µ–≥, —á—Ç–æ –≤—ã –¥–∞–ª–∏..."` ‚Üí `" –ê –¥–µ–Ω–µ–≥, —á—Ç–æ –≤—ã –¥–∞–ª–∏..."` ‚ùå (—Ç–∏—Ä–µ –ø–æ—Ç–µ—Ä—è–Ω–æ)

**–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- `"‚Äì –ü—Ä–æ—Å—Ç–æ –±—ã—Ç—å —Å–æ –º–Ω–æ–π."` ‚Üí `"‚Äî –ü—Ä–æ—Å—Ç–æ –±—ã—Ç—å —Å–æ –º–Ω–æ–π."` ‚úÖ (—Ç–∏—Ä–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ)
- `"‚Äì –ê –¥–µ–Ω–µ–≥, —á—Ç–æ –≤—ã –¥–∞–ª–∏..."` ‚Üí `"‚Äî –ê –¥–µ–Ω–µ–≥, —á—Ç–æ –≤—ã –¥–∞–ª–∏..."` ‚úÖ (—Ç–∏—Ä–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ)

## üìã –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–§–∞–π–ª:** `app/api/process/route.ts`  
**–°—Ç—Ä–æ–∫–∏:** ~175-195 (–ª–æ–≥–∏–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–∞—Ä—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–∏–º–≤–æ–ª–æ–≤)

**–¢–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏—è:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ —Ç–∏—Ä–µ

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** —Å —Ñ–∞–π–ª–æ–º `100_02_–ü–∞–∫ ***.docx`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**, —á—Ç–æ –≤—Å–µ –¥–∏–∞–ª–æ–≥–∏ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ç–∏—Ä–µ

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –í—Å–µ —Ç–∏—Ä–µ –≤ –Ω–∞—á–∞–ª–µ –¥–∏–∞–ª–æ–≥–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ En-dashes (‚Äì) –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ Em-dashes (‚Äî)
- ‚úÖ –û–±—ã—á–Ω—ã–µ –¥–µ—Ñ–∏—Å—ã (-) –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ Em-dashes (‚Äî)
- ‚úÖ –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ XML-—É–∑–ª–∞–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `app/api/process/route.ts` (–∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤)

**–¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã:** 
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–º–µ–Ω—ã —Å–∏–º–≤–æ–ª–æ–≤ —Ç–∏—Ä–µ –≤ –º–Ω–æ–≥–æ—É–∑–ª–æ–≤—ã—Ö –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞—Ö

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –ù–µ –≤–ª–∏—è—é—Ç –Ω–∞ –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üìã –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è —Ç–∏—Ä–µ –≤ –Ω–∞—á–∞–ª–µ –∞–±–∑–∞—Ü–µ–≤ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞**. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ—à–∏–±–∫—É –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –ø—Ä–∏ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –∑–∞–º–µ–Ω–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–∏—Ä–µ –Ω–∞ em-dash.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ë–õ–ï–ú–ê –ù–ê–ô–î–ï–ù–ê –ò –ò–°–ü–†–ê–í–õ–ï–ù–ê**

–¢–µ–ø–µ—Ä—å –≤—Å–µ –¥–∏–∞–ª–æ–≥–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å —Ç–∏—Ä–µ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫!